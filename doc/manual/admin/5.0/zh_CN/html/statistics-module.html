<html><head>
<!-- otrs.github.io -->
<link href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="../../../../../documentation.css">
<script src="https://code.jquery.com/jquery-1.11.0.min.js"></script>
<script type="text/javascript" src="../../../../../documentation.js"></script>
<link rel="icon" type="image/png" sizes="32x32" href="../../../../../../images/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../../../../../../images/favicon-16x16.png">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/default.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>
<script>
$(document).ready(function() {

    // Hint languages to prevent false matches (php for example).
    hljs.configure({
        languages: ['perl', 'javascript', 'xml', 'html', 'css', 'json', 'yaml']
    });

    // programlistings in manuals
    $('pre.programlisting').each(function(i, block) {
        hljs.highlightBlock(block);
    });
    // code snippets in Perl API docs
    $('.pod pre').addClass('perl').each(function(i, block) {
        hljs.highlightBlock(block);
    });
});</script>
<!-- otrs.github.io -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>统计</title><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"><link rel="home" href="index.html" title="OTRS 5 - 系统管理员手册"><link rel="up" href="administration.html" title="第 4 章 管理"><link rel="prev" href="pdf-output.html" title="定制PDF输出"><link rel="next" href="dynamicfields.html" title="动态字段"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">统计</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="pdf-output.html">上一页</a> </td><th width="60%" align="center">第 4 章 管理</th><td width="20%" align="right"> <a accesskey="n" href="dynamicfields.html">下一页</a></td></tr></table><hr></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="statistics-module"></a>统计</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="section"><a href="statistics-module.html#stats-usage">统计配置和用法</a></span></dt><dd><dl><dt><span class="section"><a href="statistics-module.html#stats-overview">概览</a></span></dt><dt><span class="section"><a href="statistics-module.html#stats-viewing-generating">生成统计</a></span></dt><dt><span class="section"><a href="statistics-module.html#stats-modify-new">配置</a></span></dt><dt><span class="section"><a href="statistics-module.html#stats-import">导入</a></span></dt></dl></dd><dt><span class="section"><a href="statistics-module.html#stats-managing-the-module">统计系统管理员</a></span></dt><dd><dl><dt><span class="section"><a href="statistics-module.html#stats-permissions">权限设置、组和队列</a></span></dt><dt><span class="section"><a href="statistics-module.html#stats-sysconfig">系统配置设置</a></span></dt><dt><span class="section"><a href="statistics-module.html#statistics-generating-on-commandline">用命令行生成统计</a></span></dt></dl></dd></dl></div><p>
OTRS统计模块支持跟踪操作的统计和生成定制的OTRS使用情况的报告的功能。OTRS系统使用“统计”术语一般指一个呈现各种指标的报表。
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">注意</h3><p>
        对<a class="ulink" href="https://www.otrs.com/solutions/" target="_top"><span class="bold"><strong>OTRS
Business Solution™（OTRS商业版）</strong></span></a>
的客户，还有一个专用的报表生成器可用。这里的“报表”指在一个PDF文档中数个统计的集合，可以轻松配置并自动生成和分发PDF文档。请在<a class="ulink" href="http://otrs.github.io/doc/manual/otrs-business-solution/stable/en/html/index.html" target="_top"><span class="bold"><strong>OTRS Business Solution™</strong></span>（OTRS商业版）手册</a>中查找更详细的信息。
    </p></div><p>
OTRS统计模块的合理配置与大量的需求和考量相关，包括评估多种OTRS模块、用户权限设置、计算指标及其复杂性级别、统计模块配置的易用性、计算的速度和效率以及支持一组丰富的输出变量。
</p><p>
统计的元素如文件（增补了统计模块特定需求的功能）可以集成来计算复杂的统计数据。
</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="stats-usage"></a>统计配置和用法</h3></div></div></div><p>
作为服务人员登录时，可以通过选择主菜单中的“报表”和“统计”来打开统计模块。
</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="stats-overview"></a>概览</h4></div></div></div><p>
    从导航栏选择“统计”然后点击子菜单“概览”可以调出概览窗口。概览窗口提供了该服务人员能够使用的预配置报表的列表（见下图）。
    </p><p>
        </p><div class="figure"><a name="id-1.6.10.6.3.3.1"></a><p class="title"><b>图 4.72. 标准统计概览</b></p><div class="figure-contents"><div class="screenshot"><div><img src="screenshots/administration/stats/stats-overview.png" alt="标准统计概览"></div></div></div></div><p><br class="figure-break">
    </p><p>
    统计模块安装后，它预先加载了导入到系统中的一些示例统计，这些统计在概览窗口显示为一个列表。如果单个列表扩展为多面显示的列表，服务人员可以在不同的页面切换浏览。点击列表上期望排序的列标题，统计列表可以按期望排序。要生成一个特定的统计，在这个统计上点击“立即运行”链接即可。
    </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="stats-viewing-generating"></a>生成统计</h4></div></div></div><p>
    查看统计界面提供了统计的配置设置（见下图）。
    </p><p>
        </p><div class="figure"><a name="id-1.6.10.6.4.3.1"></a><p class="title"><b>图 4.73. 查看一个特定的统计。</b></p><div class="figure-contents"><div class="screenshot"><a name="stats-view-screenshot"></a><div><img src="screenshots/administration/stats/stats-view.png" alt="查看一个特定的统计。"></div></div></div></div><p><br class="figure-break">
    </p><p>
    可以在编辑窗口设置一个特定统计有限的配置选项。统计创建者或其它有合适权限的人员可以编辑这些设置。
    </p><p>
    点击“立即运行”按钮（在窗口左侧）可以生成这个统计。
    </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="stats-modify-new"></a>配置</h4></div></div></div><p>
    有写入权限的服务人员可以在统计模块的编辑界面编辑一个已有的报表配置。另外，他们也可以创建一个新的报表。
    </p><p>
    配置一个统计有4个可能的步骤：一般预设数据、配置X轴、配置Y轴和可能的报表数据过滤器（或限制）。让我们创建一个新的示例统计，在概览窗口点击“添加”按钮。我们的目标是获取每个队列（X轴）和每个状态（Y轴）有多少工单优先级是非常高的列表。
    </p><p>
        </p><div class="figure"><a name="id-1.6.10.6.5.4.1"></a><p class="title"><b>图 4.74. 添加一个新的统计，第一步。</b></p><div class="figure-contents"><div class="screenshot"><div><img src="screenshots/administration/stats/stats-add-typeselection.png" alt="添加一个新的统计，第一步。"></div></div></div></div><p><br class="figure-break">
    </p><p>
        在开始页面我们必须选择要添加的统计的类型。有3个可用的类型：
    </p><p>
        </p><div class="variablelist"><dl class="variablelist"><dt><span class="term">动态矩阵统计</span></dt><dd><p>
                        这个类型的统计会生成一个计算值的矩阵（例如：月度和队列每天的新工单）。矩阵中所有的单元格值类型相同（数字、平均时间等等）。值通过系统中的条目（例如：工单）计算而来。一些矩阵统计支持一个汇总列和/或汇总行（只对某些数据有用）。
                    </p></dd><dt><span class="term">动态列表统计</span></dt><dd><p>
                        这种统计会生成一个表格，表格的每一行（不是单元格）代表系统中的一个实体（例如：一个工单），这一行的每列通常是可以配置的（X轴，见下）并包含这个对象的数据（例如：工单属性）。一列的所有单元格值的类型相同。
                    </p></dd><dt><span class="term">静态统计</span></dt><dd><p>
                        这种统计很少配置，通常用于非常特殊和/或复杂的计算。
                    </p></dd></dl></div><p>
    </p><p>
        所以在本示例中让我们选择“动态矩阵”。然后在统计类型下会出现“一般设定”的配置。
    </p><p>
        </p><div class="figure"><a name="id-1.6.10.6.5.8.1"></a><p class="title"><b>图 4.75. 添加一个新的统计，第二步。</b></p><div class="figure-contents"><div class="screenshot"><div><img src="screenshots/administration/stats/stats-add-general.png" alt="添加一个新的统计，第二步。"></div></div></div></div><p><br class="figure-break">
    </p><p>
        提供新统计的标题和描述后，我们必须选择要使用的统计后端。这是负责收集和分析统计数据的实际后端模块。在我们的例子中我们选择“TicketAccumulation（累积工单）”。
    </p><p>
        通过配置权限组，我们能够促进谁可以在后面查看和生成预配置的统计的组限制（也就是服务人员）。所以可以给需要统计的不同部门和工作组分配多个不同的统计。也可以将一个统计分配给多个组。
    </p><p>
        </p><div class="example"><a name="id-1.6.10.6.5.11.1"></a><p class="title"><b>例 4.20. 默认统计权限组</b></p><div class="example-contents"><p>
                选择“stats”组，对“stats”组至少有‘只读’权限的用户均可查看这个报表。这个访问权限是默认可用的。
            </p></div></div><p><br class="example-break">
    </p><p>
        </p><div class="example"><a name="id-1.6.10.6.5.12.1"></a><p class="title"><b>例 4.21. 定制统计权限组</b></p><div class="example-contents"><p>
                选择一个名为“sales”的组，对“sales”组有‘只读’权限的用户均可查看并生成这个报表。但是其它用户无法查看这个报表。
            </p></div></div><p><br class="example-break">
    </p><p>
        此外，还可以选择输出格式。在这里我们只需保持所有输出格式并在实际生成统计时再选择一个输出格式。现在让我们保存这个统计。
    </p><p>
        “保存”统计后会出现下一个窗口：配置X轴。点击“X轴”按钮，出现一个对话框，我们可以选择用于X轴的元素。在我们的例子中就是‘队列’：
    </p><p>
        </p><div class="figure"><a name="id-1.6.10.6.5.15.1"></a><p class="title"><b>图 4.76. 配置一个统计的X轴。</b></p><div class="figure-contents"><div class="screenshot"><div><img src="screenshots/administration/stats/stats-config-xaxis.png" alt="配置一个统计的X轴。"></div></div></div></div><p><br class="figure-break">
    </p><p>
        通过在队列字段选择一些队列，我们可以随意地限制要显示的队列。通过复选框我们能够控制服务人员生成统计时是否可以修改选择的队列。我们保持默认并点击“保存”按钮。
    </p><p>
        现在我们可以通过相同的方法配置Y轴：选择‘状态’字段
    </p><p>
        </p><div class="figure"><a name="id-1.6.10.6.5.18.1"></a><p class="title"><b>图 4.77. 配置一个统计的Y轴。</b></p><div class="figure-contents"><div class="screenshot"><div><img src="screenshots/administration/stats/stats-config-yaxis.png" alt="配置一个统计的Y轴。"></div></div></div></div><p><br class="figure-break">
    </p><p>
        在这里可以选择一个或两个元素。一个元素时，元素的每个值就是Y轴的一个元素。如果选择了两个元素，它们的排列就是值系列（Y轴）的元素。例如你可以选择“状态”和“优先级”，结果元素就是“新建-1-非常低”、“新建-2-低”
... “处理中-1-非常低”等等。让我们仅使用“状态”并点击“保存”。
    </p><p>
        现在最后一步，我们可以添加数据过滤器以便只统计属于某个客户某个优先级等条件的工单。我们添加一个‘非常高’优先级的工单过滤器：
    </p><p>
        </p><div class="figure"><a name="id-1.6.10.6.5.21.1"></a><p class="title"><b>图 4.78. 配置一个统计的数据过滤器。</b></p><div class="figure-contents"><div class="screenshot"><div><img src="screenshots/administration/stats/stats-config-filter.png" alt="配置一个统计的数据过滤器。"></div></div></div></div><p><br class="figure-break">
    </p><p>
        现在再次点击“保存”按钮，配置就完成了。
    </p><p>
        你可以已经注意到了，在配置对话框有一个统计预览区域，我们可以在这里检查配置设置的效果。
    </p><p>
        </p><div class="figure"><a name="id-1.6.10.6.5.24.1"></a><p class="title"><b>图 4.79. 配置一个统计的数据过滤器。</b></p><div class="figure-contents"><div class="screenshot"><div><img src="screenshots/administration/stats/stats-config-preview.png" alt="配置一个统计的数据过滤器。"></div></div></div></div><p><br class="figure-break">
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">注意</h3><p>
            请注意预览使用的是随机数据且没有考虑数据过滤器。
        </p></div><p>
        统计已经配置好了，点击“立即运行”按钮，我们能够进入查看窗口选择输出格式，统计可以用不同格式生成。
    </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="stats-import"></a>导入</h4></div></div></div><p>
        可以通过点击统计概览窗口的“导入”按钮访问导入界面，需要统计模块的“读写”权限。
    </p><p>
        </p><div class="figure"><a name="id-1.6.10.6.6.3.1"></a><p class="title"><b>图 4.80. 导入统计</b></p><div class="figure-contents"><div class="screenshot"><div><img src="screenshots/administration/stats/stats-import.png" alt="导入统计"></div></div></div></div><p><br class="figure-break">
    </p><p>
        促进统计模块的报表导入与导出功能结合使用，是一个非常方便的功能。可以在测试系统中方便地创建和测试统计，然后导入到生产系统。
    </p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="stats-managing-the-module"></a>统计系统管理员</h3></div></div></div><p>
    本部分提供系统管理员处理统计模块的任务和职责的信息。
    </p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="stats-permissions"></a>权限设置、组和队列</h4></div></div></div><p>
            统计模块注册的默认配置给所有服务人员有“stats”组权限来访问统计模块。
        </p><p>
            根据权限设置的访问：

            </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p><span class="emphasis"><em>rw（读写）</em></span>，允许配置统计。</p></li><li class="listitem"><p><span class="emphasis"><em>ro（只读）</em></span>，允许生成预先配置的统计。</p></li></ul></div><p>
        </p><p>
            OTRS系统管理员决定是将有权限生成预先配置的报表服务人员分配“stats”组的‘只读’权限，还是将他们各自的组加入系统配置中的模块注册信息。
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="stats-sysconfig"></a>系统配置设置</h4></div></div></div><p>
        系统配置组<a class="link" href="ConfigReference_Framework.html#ConfigReference_Framework:Core::Stats" title="Framework → Core::Stats">Framework:Core::Stats</a>和<a class="link" href="ConfigReference_Framework.html#ConfigReference_Framework:Frontend::Agent::Stats" title="Framework → Frontend::Agent::Stats">Framework:Frontend::Agent::Stats</a>包含了所有的统计模块基本设置参数。此外，配置参数<a class="link" href="ConfigReference_Framework.html#ConfigReference_Framework:Frontend::Agent::ModuleRegistration:Frontend::Module_AgentStatistics">$Self-&gt;{'Frontend::Module'}-&gt;{'AgentStats'}</a>控制统计模块内模块和图标的布局和注册信息。
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="statistics-generating-on-commandline"></a>用命令行生成统计</h4></div></div></div><p>
            可以在命令行执行命令<code class="filename">bin/otrs.Console.pl
Maint::Stats::Generate</code>来生成统计。举个例子，查看下面脚本中的命令行调用。
        </p><p>
            </p><pre class="programlisting">
shell&gt; bin/otrs.Console.pl Maint::Stats::Generate --number 10004 --target-directory /tmp
Generating statistic number 10004...
  Writing file /tmp/List_of_the_most_time-consuming_tickets_Created_2015-09-08_14-51.csv.
Done.
            </pre><p>
        </p><p>
            从统计配置“Stat#10004”生成报表并保存为一个CSV文件到<code class="filename">/tmp</code>目录。
        </p><p>
            生成的报表还可以作为邮件发送，可以执行下面脚本中的命令获取更多信息。
        </p><p>
            </p><pre class="programlisting">
shell&gt; bin/otrs.Console.pl Maint::Stats::Generate --help
            </pre><p>
        </p><p>
            通常通过命令行手动生成报表没有什么意义，因为统计模块有一个便利的图形界面。但是，结合一个cron任务来手动生成报表就有意义了。
        </p><p>
            想像下列场景:每月的第一天，部门领导要收到一份过去一月的报表。通过结合cron任务和命令行生成报表可以通过邮件自动将报表发送给他们。
        </p></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="pdf-output.html">上一页</a> </td><td width="20%" align="center"><a accesskey="u" href="administration.html">上一级</a></td><td width="40%" align="right"> <a accesskey="n" href="dynamicfields.html">下一页</a></td></tr><tr><td width="40%" align="left" valign="top">定制PDF输出 </td><td width="20%" align="center"><a accesskey="h" href="index.html">起始页</a></td><td width="40%" align="right" valign="top"> 动态字段</td></tr></table></div></body></html>
