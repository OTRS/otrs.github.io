

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Create New Dynamic Field &mdash; OTRS Developer Manual 8.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../../../_static/css/otrs.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Creating a Dynamic Field Functionality Extension" href="dynamic-fields-extend.html" />
    <link rel="prev" title="How To Extend The Dynamic Fields" href="dynamic-fields-extend-options.html" /> 

  
  <script src="../../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          
    
    
    <a href="https://doc.otrs.com/doc" class="icon fa-rocket DocumentationOverview"> OTRS Documentation</a>

    

          
            <a href="../../../index.html" class="icon icon-home"> OTRS Developer Manual
          

          
            
            <img src="../../../../_static/otrs-logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                8.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          


        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../get-started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../how-it-works.html">OTRS Internals - How it Works</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../how-to-extend-otrs.html">How to Extend OTRS</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../writing-otrs-application.html">Writing A New OTRS Front End Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../writing-new-otrs-frontend-component.html">Writing A New OTRS Front End Component</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../otrs-module-layers.html">Using the power of the OTRS module layers</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../agent-auth.html">Agent Authentication Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auth-sync.html">Authentication Synchronization Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../customer-auth.html">Customer Authentication Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../customer-user-preferences.html">Customer User Preferences Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../queue-preferences.html">Queue Preferences Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../service-preferences.html">Service Preferences Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sla-preferences.html">SLA Preferences Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../log.html">Log Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../outputfilter.html">Output Filter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stats.html">Stats Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ticketnumber-generator.html">Ticket Number Generator Modules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ticketevent.html">Ticket Event Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dashboard.html">Dashboard Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../notify.html">Notification Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ticket-menu.html">Ticket Menu Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rootapplication.html">Root Application Module Layer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gi-transport.html">Network Transport</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gi-mapping.html">Mapping</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gi-invoker.html">Invoker</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gi-operation.html">Operation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../daemon/daemon-modules.html">OTRS Daemon</a></li>
<li class="toctree-l3"><a class="reference internal" href="../daemon/scheduler-task-worker-modules.html">OTRS Scheduler</a></li>
<li class="toctree-l3"><a class="reference internal" href="dynamic-fields-overview.html">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="dynamic-fields-framework.html">Dynamic Fields Framework</a></li>
<li class="toctree-l3"><a class="reference internal" href="dynamic-fields-interaction.html">Dynamic Field Interaction With Front End Modules</a></li>
<li class="toctree-l3"><a class="reference internal" href="dynamic-fields-extend-options.html">How To Extend The Dynamic Fields</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Create New Dynamic Field</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#dynamic-field-password-files">Dynamic Field Password Files</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dynamic-fields-extend.html">Creating a Dynamic Field Functionality Extension</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ticket-postmaster-modules.html">Ticket Postmaster Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../process-management-modules.html">Process Management</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../how-to-publish-otrs-extensions.html">How to Publish Your OTRS Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../documentation.html">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contributing.html">Contributing to OTRS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../additional-resources.html">Additional Resources</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">OTRS Developer Manual</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../../how-to-extend-otrs.html">How to Extend OTRS</a> &raquo;</li>
        
          <li><a href="../../otrs-module-layers.html">Using the power of the OTRS module layers</a> &raquo;</li>
        
      <li>Create New Dynamic Field</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/OTRS/doc-developer/blob/master/content/how-to-extend-otrs/otrs-module-layers/dynamic-fields/dynamic-fields-new-field.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="create-new-dynamic-field">
<h1>Create New Dynamic Field<a class="headerlink" href="#create-new-dynamic-field" title="Permalink to this headline">¶</a></h1>
<p>To illustrate this process a new dynamic field <em>Password</em> will be created. This new dynamic field type will show a new password field to ticket or article objects. Since is very similar to a text dynamic field
we will use the <code class="docutils literal notranslate"><span class="pre">Base</span></code> and <code class="docutils literal notranslate"><span class="pre">BaseText</span></code> drivers (for the legacy API) and <code class="docutils literal notranslate"><span class="pre">Base/Text</span></code> (for the new API) as a basis to build this new field.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This new password field implementation is just for educational purposes, it does not provide any level of security and is not recommended for production systems.</p>
</div>
<p>To create this new dynamic field, we will create 5 files:</p>
<ol class="arabic simple">
<li>A configuration file (XML) to register the modules.</li>
<li>An admin dialog module (Perl) to setup the field options.</li>
<li>A template module for the admin dialog.</li>
<li>A dynamic field legacy driver (Perl).</li>
<li>A dynamic field driver (Perl).</li>
</ol>
<p>File structure:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$HOME (e. g. /opt/otrs/)
|
...
|--/Kernel/
|   |--/Config/
|   |   |--/Files/
|   |   |   |--/XML/
|   |   |   |   |DynamicFieldPassword.xml
...
|   |--/Modules/
|   |   |AdminDynamicFieldPassword.pm
...
|   |--/Output/
|   |   |--/HTML/
|   |   |   |--/Standard/
|   |   |   |   |AdminDynamicFieldPassword.tt
...
|   |--/System/
|   |   |--/DynamicFieldLegacy/
|   |   |   |--/Driver/
|   |   |   |   |Password.pm
...
|   |   |--/DynamicField/
|   |   |   |--/Driver/
|   |   |   |   |Password.pm
...
</pre></div>
</div>
<div class="section" id="dynamic-field-password-files">
<h2>Dynamic Field Password Files<a class="headerlink" href="#dynamic-field-password-files" title="Permalink to this headline">¶</a></h2>
<div class="section" id="dynamic-field-configuration-file-example">
<h3>Dynamic Field Configuration File Example<a class="headerlink" href="#dynamic-field-configuration-file-example" title="Permalink to this headline">¶</a></h3>
<p>The configuration files are used to register the dynamic field types (driver) and the object type drivers for the back end object. They also store standard registrations for admin modules in the framework.</p>
<p>In this section a configuration file for password dynamic field is shown and explained.</p>
<div class="highlight-XML notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;</span>
<span class="nt">&lt;otrs_config</span> <span class="na">version=</span><span class="s">&quot;2.0&quot;</span> <span class="na">init=</span><span class="s">&quot;Application&quot;</span><span class="nt">&gt;</span>
</pre></div>
</div>
<p>This is the normal header for a configuration file.</p>
<div class="highlight-XML notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ConfigItem</span> <span class="na">Name=</span><span class="s">&quot;DynamicFieldsLegacy::Driver###Password&quot;</span> <span class="na">Required=</span><span class="s">&quot;0&quot;</span> <span class="na">Valid=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Description</span> <span class="na">Translatable=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>DynamicField legacy backend registration.<span class="nt">&lt;/Description&gt;</span>
    <span class="nt">&lt;Group&gt;</span>DynamicFieldPassword<span class="nt">&lt;/Group&gt;</span>
    <span class="nt">&lt;SubGroup&gt;</span>DynamicFields::Backend::Registration<span class="nt">&lt;/SubGroup&gt;</span>
    <span class="nt">&lt;Setting&gt;</span>
        <span class="nt">&lt;Hash&gt;</span>
            <span class="nt">&lt;Item</span> <span class="na">Key=</span><span class="s">&quot;DisplayName&quot;</span> <span class="na">Translatable=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>Password<span class="nt">&lt;/Item&gt;</span>
            <span class="nt">&lt;Item</span> <span class="na">Key=</span><span class="s">&quot;Module&quot;</span><span class="nt">&gt;</span>Kernel::System::DynamicFieldLegacy::Driver::Password<span class="nt">&lt;/Item&gt;</span>
            <span class="nt">&lt;Item</span> <span class="na">Key=</span><span class="s">&quot;ConfigDialog&quot;</span><span class="nt">&gt;</span>AdminDynamicFieldPassword<span class="nt">&lt;/Item&gt;</span>
        <span class="nt">&lt;/Hash&gt;</span>
    <span class="nt">&lt;/Setting&gt;</span>
<span class="nt">&lt;/ConfigItem&gt;</span>

<span class="nt">&lt;ConfigItem</span> <span class="na">Name=</span><span class="s">&quot;DynamicFields::Driver###Password&quot;</span> <span class="na">Required=</span><span class="s">&quot;0&quot;</span> <span class="na">Valid=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Description</span> <span class="na">Translatable=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>DynamicField backend registration.<span class="nt">&lt;/Description&gt;</span>
    <span class="nt">&lt;Group&gt;</span>DynamicFieldPassword<span class="nt">&lt;/Group&gt;</span>
    <span class="nt">&lt;SubGroup&gt;</span>DynamicFields::Backend::Registration<span class="nt">&lt;/SubGroup&gt;</span>
    <span class="nt">&lt;Setting&gt;</span>
        <span class="nt">&lt;Hash&gt;</span>
            <span class="nt">&lt;Item</span> <span class="na">Key=</span><span class="s">&quot;DisplayName&quot;</span> <span class="na">Translatable=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>Password<span class="nt">&lt;/Item&gt;</span>
            <span class="nt">&lt;Item</span> <span class="na">Key=</span><span class="s">&quot;Module&quot;</span><span class="nt">&gt;</span>Kernel::System::DynamicField::Driver::Password<span class="nt">&lt;/Item&gt;</span>
            <span class="nt">&lt;Item</span> <span class="na">Key=</span><span class="s">&quot;ConfigDialog&quot;</span><span class="nt">&gt;</span>AdminDynamicFieldPassword<span class="nt">&lt;/Item&gt;</span>
        <span class="nt">&lt;/Hash&gt;</span>
    <span class="nt">&lt;/Setting&gt;</span>
<span class="nt">&lt;/ConfigItem&gt;</span>
</pre></div>
</div>
<p>These settings registers the password dynamic field driver for the back end module (legacy and new API) so it can be included in the list of available dynamic fields types. It also specify its own admin dialog in the key <code class="docutils literal notranslate"><span class="pre">ConfigDialog</span></code>. This key is used by the master dynamic field admin module to manage this new dynamic field type.</p>
<div class="highlight-XML notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ConfigItem</span> <span class="na">Name=</span><span class="s">&quot;Frontend::Module###AdminDynamicFieldPassword&quot;</span> <span class="na">Required=</span><span class="s">&quot;0&quot;</span> <span class="na">Valid=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Description</span> <span class="na">Translatable=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>Frontend module registration for the agent interface.<span class="nt">&lt;/Description&gt;</span>
    <span class="nt">&lt;Group&gt;</span>DynamicFieldPassword<span class="nt">&lt;/Group&gt;</span>
    <span class="nt">&lt;SubGroup&gt;</span>Frontend::Admin::ModuleRegistration<span class="nt">&lt;/SubGroup&gt;</span>
    <span class="nt">&lt;Setting&gt;</span>
        <span class="nt">&lt;FrontendModuleReg&gt;</span>
            <span class="nt">&lt;Group&gt;</span>admin<span class="nt">&lt;/Group&gt;</span>
            <span class="nt">&lt;Description&gt;</span>Admin<span class="nt">&lt;/Description&gt;</span>
            <span class="nt">&lt;Title</span> <span class="na">Translatable=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>Dynamic Fields Text Backend GUI<span class="nt">&lt;/Title&gt;</span>
            <span class="nt">&lt;Loader&gt;</span>
                <span class="nt">&lt;JavaScript&gt;</span>Core.Agent.Admin.DynamicField.js<span class="nt">&lt;/JavaScript&gt;</span>
            <span class="nt">&lt;/Loader&gt;</span>
        <span class="nt">&lt;/FrontendModuleReg&gt;</span>
    <span class="nt">&lt;/Setting&gt;</span>
<span class="nt">&lt;/ConfigItem&gt;</span>
</pre></div>
</div>
<p>This is a standard module registration for the password admin dialog in the admin interface.</p>
<div class="highlight-XML notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;/otrs_config&gt;</span>
</pre></div>
</div>
<p>Standard closure of a configuration file.</p>
</div>
<div class="section" id="dynamic-field-admin-dialog-example">
<h3>Dynamic Field Admin Dialog Example<a class="headerlink" href="#dynamic-field-admin-dialog-example" title="Permalink to this headline">¶</a></h3>
<p>The admin dialogs are standard admin modules to manage (add or edit) the dynamic fields.</p>
<p>In this section an admin dialog for password dynamic field is shown and explained.</p>
<div class="highlight-Perl notranslate"><div class="highlight"><pre><span></span><span class="c1"># --</span>
<span class="c1"># Kernel/Modules/AdminDynamicFieldPassword.pm - provides a dynamic fields password config view for admins</span>
<span class="c1"># Copyright (C) 2001-2019 OTRS AG, https://otrs.com/</span>
<span class="c1"># --</span>
<span class="c1"># This software comes with ABSOLUTELY NO WARRANTY. For details, see</span>
<span class="c1"># the enclosed file COPYING for license information (GPL). If you</span>
<span class="c1"># did not receive this file, see https://www.gnu.org/licenses/gpl-3.0.txt.</span>
<span class="c1"># --</span>

<span class="k">package</span> <span class="nn">Kernel::Modules::AdminDynamicFieldPassword</span><span class="p">;</span>

<span class="k">use</span> <span class="nn">strict</span><span class="p">;</span>
<span class="k">use</span> <span class="nn">warnings</span><span class="p">;</span>

<span class="k">use</span> <span class="nn">Kernel::System::VariableCheck</span> <span class="sx">qw(:all)</span><span class="p">;</span>
<span class="k">use</span> <span class="nn">Kernel::System::Valid</span><span class="p">;</span>
<span class="k">use</span> <span class="nn">Kernel::System::CheckItem</span><span class="p">;</span>
<span class="k">use</span> <span class="nn">Kernel::System::DynamicField</span><span class="p">;</span>
</pre></div>
</div>
<p>This is common header that can be found in common OTRS modules. The class/package name is declared via the <code class="docutils literal notranslate"><span class="pre">package</span></code> keyword.</p>
<div class="highlight-Perl notranslate"><div class="highlight"><pre><span></span><span class="k">sub</span> <span class="nf">new</span> <span class="p">{</span>
    <span class="k">my</span> <span class="p">(</span> <span class="nv">$Type</span><span class="p">,</span> <span class="nv">%Param</span> <span class="p">)</span> <span class="o">=</span> <span class="nv">@_</span><span class="p">;</span>

    <span class="k">my</span> <span class="nv">$Self</span> <span class="o">=</span> <span class="p">{</span><span class="nv">%Param</span><span class="p">};</span>
    <span class="nb">bless</span><span class="p">(</span> <span class="nv">$Self</span><span class="p">,</span> <span class="nv">$Type</span> <span class="p">);</span>

    <span class="k">for</span> <span class="p">(</span><span class="sx">qw(ParamObject LayoutObject LogObject ConfigObject)</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="nv">$_</span><span class="p">}</span> <span class="p">)</span> <span class="p">{</span>
            <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">LayoutObject</span><span class="p">}</span><span class="o">-&gt;</span><span class="n">FatalError</span><span class="p">(</span> <span class="n">Message</span> <span class="o">=&gt;</span> <span class="s">&quot;Got no $_!&quot;</span> <span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1"># create additional objects</span>
    <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">ValidObject</span><span class="p">}</span> <span class="o">=</span> <span class="nn">Kernel::System::Valid</span><span class="o">-&gt;</span><span class="k">new</span><span class="p">(</span> <span class="nv">%</span><span class="p">{</span><span class="nv">$Self</span><span class="p">}</span> <span class="p">);</span>

    <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">DynamicFieldObject</span><span class="p">}</span> <span class="o">=</span> <span class="nn">Kernel::System::DynamicField</span><span class="o">-&gt;</span><span class="k">new</span><span class="p">(</span> <span class="nv">%</span><span class="p">{</span><span class="nv">$Self</span><span class="p">}</span> <span class="p">);</span>

    <span class="c1"># get configured object types</span>
    <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">ObjectTypeConfig</span><span class="p">}</span> <span class="o">=</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">ConfigObject</span><span class="p">}</span><span class="o">-&gt;</span><span class="n">Get</span><span class="p">(</span><span class="s">&#39;DynamicFields::ObjectType&#39;</span><span class="p">);</span>

    <span class="c1"># get the fields config</span>
    <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">FieldTypeConfig</span><span class="p">}</span> <span class="o">=</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">ConfigObject</span><span class="p">}</span><span class="o">-&gt;</span><span class="n">Get</span><span class="p">(</span><span class="s">&#39;DynamicFields::Backend&#39;</span><span class="p">)</span> <span class="o">||</span> <span class="p">{};</span>

    <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">DefaultValueMask</span><span class="p">}</span> <span class="o">=</span> <span class="s">&#39;****&#39;</span><span class="p">;</span>
    <span class="k">return</span> <span class="nv">$Self</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The constructor <code class="docutils literal notranslate"><span class="pre">new</span></code> creates a new instance of the class. According to the coding guidelines objects of other classes that are needed in this module have to be created in <code class="docutils literal notranslate"><span class="pre">new</span></code>.</p>
<div class="highlight-Perl notranslate"><div class="highlight"><pre><span></span><span class="k">sub</span> <span class="nf">Run</span> <span class="p">{</span>
    <span class="k">my</span> <span class="p">(</span> <span class="nv">$Self</span><span class="p">,</span> <span class="nv">%Param</span> <span class="p">)</span> <span class="o">=</span> <span class="nv">@_</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">Subaction</span><span class="p">}</span> <span class="ow">eq</span> <span class="s">&#39;Add&#39;</span> <span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="n">_Add</span><span class="p">(</span>
            <span class="nv">%Param</span><span class="p">,</span>
        <span class="p">);</span>
    <span class="p">}</span>
    <span class="k">elsif</span> <span class="p">(</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">Subaction</span><span class="p">}</span> <span class="ow">eq</span> <span class="s">&#39;AddAction&#39;</span> <span class="p">)</span> <span class="p">{</span>

        <span class="c1"># challenge token check for write action</span>
        <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">LayoutObject</span><span class="p">}</span><span class="o">-&gt;</span><span class="n">ChallengeTokenCheck</span><span class="p">();</span>

        <span class="k">return</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="n">_AddAction</span><span class="p">(</span>
            <span class="nv">%Param</span><span class="p">,</span>
        <span class="p">);</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">Subaction</span><span class="p">}</span> <span class="ow">eq</span> <span class="s">&#39;Change&#39;</span> <span class="p">)</span> <span class="p">{</span>

        <span class="k">return</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="n">_Change</span><span class="p">(</span>
            <span class="nv">%Param</span><span class="p">,</span>
        <span class="p">);</span>
    <span class="p">}</span>
    <span class="k">elsif</span> <span class="p">(</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">Subaction</span><span class="p">}</span> <span class="ow">eq</span> <span class="s">&#39;ChangeAction&#39;</span> <span class="p">)</span> <span class="p">{</span>

        <span class="c1"># challenge token check for write action</span>
        <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">LayoutObject</span><span class="p">}</span><span class="o">-&gt;</span><span class="n">ChallengeTokenCheck</span><span class="p">();</span>

        <span class="k">return</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="n">_ChangeAction</span><span class="p">(</span>
            <span class="nv">%Param</span><span class="p">,</span>
        <span class="p">);</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">LayoutObject</span><span class="p">}</span><span class="o">-&gt;</span><span class="n">ErrorScreen</span><span class="p">(</span>
        <span class="n">Message</span> <span class="o">=&gt;</span> <span class="s">&quot;Undefined subaction.&quot;</span><span class="p">,</span>
    <span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Run</span></code> is the default function to be called by the web request. We try to make this function as simple as possible and let the helper functions to do the hard work.</p>
<div class="highlight-Perl notranslate"><div class="highlight"><pre><span></span><span class="k">sub</span> <span class="nf">_Add</span> <span class="p">{</span>
    <span class="k">my</span> <span class="p">(</span> <span class="nv">$Self</span><span class="p">,</span> <span class="nv">%Param</span> <span class="p">)</span> <span class="o">=</span> <span class="nv">@_</span><span class="p">;</span>

    <span class="k">my</span> <span class="nv">%GetParam</span><span class="p">;</span>
    <span class="k">for</span> <span class="k">my</span> <span class="nv">$Needed</span> <span class="p">(</span><span class="sx">qw(ObjectType FieldType FieldOrder)</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$GetParam</span><span class="p">{</span><span class="nv">$Needed</span><span class="p">}</span> <span class="o">=</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">ParamObject</span><span class="p">}</span><span class="o">-&gt;</span><span class="n">GetParam</span><span class="p">(</span> <span class="n">Param</span> <span class="o">=&gt;</span> <span class="nv">$Needed</span> <span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nv">$Needed</span> <span class="p">)</span> <span class="p">{</span>

            <span class="k">return</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">LayoutObject</span><span class="p">}</span><span class="o">-&gt;</span><span class="n">ErrorScreen</span><span class="p">(</span>
                <span class="n">Message</span> <span class="o">=&gt;</span> <span class="s">&quot;Need $Needed&quot;</span><span class="p">,</span>
            <span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1"># get the object type and field type display name</span>
    <span class="k">my</span> <span class="nv">$ObjectTypeName</span> <span class="o">=</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">ObjectTypeConfig</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span> <span class="nv">$GetParam</span><span class="p">{</span><span class="n">ObjectType</span><span class="p">}</span> <span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">DisplayName</span><span class="p">}</span> <span class="o">||</span> <span class="s">&#39;&#39;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$FieldTypeName</span>  <span class="o">=</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">FieldTypeConfig</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span> <span class="nv">$GetParam</span><span class="p">{</span><span class="n">FieldType</span><span class="p">}</span> <span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">DisplayName</span><span class="p">}</span>   <span class="o">||</span> <span class="s">&#39;&#39;</span><span class="p">;</span>

    <span class="k">return</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="n">_ShowScreen</span><span class="p">(</span>
        <span class="nv">%Param</span><span class="p">,</span>
        <span class="nv">%GetParam</span><span class="p">,</span>
        <span class="n">Mode</span>           <span class="o">=&gt;</span> <span class="s">&#39;Add&#39;</span><span class="p">,</span>
        <span class="n">ObjectTypeName</span> <span class="o">=&gt;</span> <span class="nv">$ObjectTypeName</span><span class="p">,</span>
        <span class="n">FieldTypeName</span>  <span class="o">=&gt;</span> <span class="nv">$FieldTypeName</span><span class="p">,</span>
    <span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">_Add</span></code> function is also pretty simple, it just get some parameters from the web request and call the <code class="docutils literal notranslate"><span class="pre">_ShowScreen()</span></code> function. Normally this function is not needed to be modified.</p>
<div class="highlight-Perl notranslate"><div class="highlight"><pre><span></span><span class="k">sub</span> <span class="nf">_AddAction</span> <span class="p">{</span>
    <span class="k">my</span> <span class="p">(</span> <span class="nv">$Self</span><span class="p">,</span> <span class="nv">%Param</span> <span class="p">)</span> <span class="o">=</span> <span class="nv">@_</span><span class="p">;</span>

    <span class="k">my</span> <span class="nv">%Errors</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">%GetParam</span><span class="p">;</span>

    <span class="k">for</span> <span class="k">my</span> <span class="nv">$Needed</span> <span class="p">(</span><span class="sx">qw(Name Label FieldOrder)</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$GetParam</span><span class="p">{</span><span class="nv">$Needed</span><span class="p">}</span> <span class="o">=</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">ParamObject</span><span class="p">}</span><span class="o">-&gt;</span><span class="n">GetParam</span><span class="p">(</span> <span class="n">Param</span> <span class="o">=&gt;</span> <span class="nv">$Needed</span> <span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nv">$GetParam</span><span class="p">{</span><span class="nv">$Needed</span><span class="p">}</span> <span class="p">)</span> <span class="p">{</span>
            <span class="nv">$Errors</span><span class="p">{</span> <span class="nv">$Needed</span> <span class="o">.</span> <span class="s">&#39;ServerError&#39;</span> <span class="p">}</span>        <span class="o">=</span> <span class="s">&#39;ServerError&#39;</span><span class="p">;</span>
            <span class="nv">$Errors</span><span class="p">{</span> <span class="nv">$Needed</span> <span class="o">.</span> <span class="s">&#39;ServerErrorMessage&#39;</span> <span class="p">}</span> <span class="o">=</span> <span class="s">&#39;This field is required.&#39;</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span> <span class="nv">$GetParam</span><span class="p">{</span><span class="n">Name</span><span class="p">}</span> <span class="p">)</span> <span class="p">{</span>

        <span class="c1"># check if name is alphanumeric</span>
        <span class="k">if</span> <span class="p">(</span> <span class="nv">$GetParam</span><span class="p">{</span><span class="n">Name</span><span class="p">}</span> <span class="o">!~</span> <span class="sr">m{\A ( ?: [a-zA-Z] | \d )+ \z}xms</span> <span class="p">)</span> <span class="p">{</span>

            <span class="c1"># add server error error class</span>
            <span class="nv">$Errors</span><span class="p">{</span><span class="n">NameServerError</span><span class="p">}</span> <span class="o">=</span> <span class="s">&#39;ServerError&#39;</span><span class="p">;</span>
            <span class="nv">$Errors</span><span class="p">{</span><span class="n">NameServerErrorMessage</span><span class="p">}</span> <span class="o">=</span>
                <span class="s">&#39;The field does not contain only ASCII letters and numbers.&#39;</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="c1"># check if name is duplicated</span>
        <span class="k">my</span> <span class="nv">%DynamicFieldsList</span> <span class="o">=</span> <span class="nv">%</span><span class="p">{</span>
            <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">DynamicFieldObject</span><span class="p">}</span><span class="o">-&gt;</span><span class="n">DynamicFieldList</span><span class="p">(</span>
                <span class="n">Valid</span>      <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">ResultType</span> <span class="o">=&gt;</span> <span class="s">&#39;HASH&#39;</span><span class="p">,</span>
                <span class="p">)</span>
        <span class="p">};</span>

        <span class="nv">%DynamicFieldsList</span> <span class="o">=</span> <span class="nb">reverse</span> <span class="nv">%DynamicFieldsList</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span> <span class="nv">$DynamicFieldsList</span><span class="p">{</span> <span class="nv">$GetParam</span><span class="p">{</span><span class="n">Name</span><span class="p">}</span> <span class="p">}</span> <span class="p">)</span> <span class="p">{</span>

            <span class="c1"># add server error error class</span>
            <span class="nv">$Errors</span><span class="p">{</span><span class="n">NameServerError</span><span class="p">}</span>        <span class="o">=</span> <span class="s">&#39;ServerError&#39;</span><span class="p">;</span>
            <span class="nv">$Errors</span><span class="p">{</span><span class="n">NameServerErrorMessage</span><span class="p">}</span> <span class="o">=</span> <span class="s">&#39;There is another field with the same name.&#39;</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span> <span class="nv">$GetParam</span><span class="p">{</span><span class="n">FieldOrder</span><span class="p">}</span> <span class="p">)</span> <span class="p">{</span>

        <span class="c1"># check if field order is numeric and positive</span>
        <span class="k">if</span> <span class="p">(</span> <span class="nv">$GetParam</span><span class="p">{</span><span class="n">FieldOrder</span><span class="p">}</span> <span class="o">!~</span> <span class="sr">m{\A ( ?: \d )+ \z}xms</span> <span class="p">)</span> <span class="p">{</span>

            <span class="c1"># add server error error class</span>
            <span class="nv">$Errors</span><span class="p">{</span><span class="n">FieldOrderServerError</span><span class="p">}</span>        <span class="o">=</span> <span class="s">&#39;ServerError&#39;</span><span class="p">;</span>
            <span class="nv">$Errors</span><span class="p">{</span><span class="n">FieldOrderServerErrorMessage</span><span class="p">}</span> <span class="o">=</span> <span class="s">&#39;The field must be numeric.&#39;</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">for</span> <span class="k">my</span> <span class="nv">$ConfigParam</span> <span class="p">(</span>
        <span class="sx">qw(</span>
<span class="sx">        ObjectType ObjectTypeName FieldType FieldTypeName DefaultValue ValidID ShowValue</span>
<span class="sx">        ValueMask</span>
<span class="sx">        )</span>
        <span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$GetParam</span><span class="p">{</span><span class="nv">$ConfigParam</span><span class="p">}</span> <span class="o">=</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">ParamObject</span><span class="p">}</span><span class="o">-&gt;</span><span class="n">GetParam</span><span class="p">(</span> <span class="n">Param</span> <span class="o">=&gt;</span> <span class="nv">$ConfigParam</span> <span class="p">);</span>
    <span class="p">}</span>

    <span class="c1"># uncorrectable errors</span>
    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nv">$GetParam</span><span class="p">{</span><span class="n">ValidID</span><span class="p">}</span> <span class="p">)</span> <span class="p">{</span>

        <span class="k">return</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">LayoutObject</span><span class="p">}</span><span class="o">-&gt;</span><span class="n">ErrorScreen</span><span class="p">(</span>
            <span class="n">Message</span> <span class="o">=&gt;</span> <span class="s">&quot;Need ValidID&quot;</span><span class="p">,</span>
        <span class="p">);</span>
    <span class="p">}</span>

    <span class="c1"># return to add screen if errors</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">%Errors</span><span class="p">)</span> <span class="p">{</span>

        <span class="k">return</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="n">_ShowScreen</span><span class="p">(</span>
            <span class="nv">%Param</span><span class="p">,</span>
            <span class="nv">%Errors</span><span class="p">,</span>
            <span class="nv">%GetParam</span><span class="p">,</span>
            <span class="n">Mode</span> <span class="o">=&gt;</span> <span class="s">&#39;Add&#39;</span><span class="p">,</span>
        <span class="p">);</span>
    <span class="p">}</span>

    <span class="c1"># set specific config</span>
    <span class="k">my</span> <span class="nv">$FieldConfig</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">DefaultValue</span> <span class="o">=&gt;</span> <span class="nv">$GetParam</span><span class="p">{</span><span class="n">DefaultValue</span><span class="p">},</span>
        <span class="n">ShowValue</span>    <span class="o">=&gt;</span> <span class="nv">$GetParam</span><span class="p">{</span><span class="n">ShowValue</span><span class="p">},</span>
        <span class="n">ValueMask</span>    <span class="o">=&gt;</span> <span class="nv">$GetParam</span><span class="p">{</span><span class="n">ValueMask</span><span class="p">}</span> <span class="o">||</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">DefaultValueMask</span><span class="p">},</span>
    <span class="p">};</span>

    <span class="c1"># create a new field</span>
    <span class="k">my</span> <span class="nv">$FieldID</span> <span class="o">=</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">DynamicFieldObject</span><span class="p">}</span><span class="o">-&gt;</span><span class="n">DynamicFieldAdd</span><span class="p">(</span>
        <span class="n">Name</span>       <span class="o">=&gt;</span> <span class="nv">$GetParam</span><span class="p">{</span><span class="n">Name</span><span class="p">},</span>
        <span class="n">Label</span>      <span class="o">=&gt;</span> <span class="nv">$GetParam</span><span class="p">{</span><span class="n">Label</span><span class="p">},</span>
        <span class="n">FieldOrder</span> <span class="o">=&gt;</span> <span class="nv">$GetParam</span><span class="p">{</span><span class="n">FieldOrder</span><span class="p">},</span>
        <span class="n">FieldType</span>  <span class="o">=&gt;</span> <span class="nv">$GetParam</span><span class="p">{</span><span class="n">FieldType</span><span class="p">},</span>
        <span class="n">ObjectType</span> <span class="o">=&gt;</span> <span class="nv">$GetParam</span><span class="p">{</span><span class="n">ObjectType</span><span class="p">},</span>
        <span class="n">Config</span>     <span class="o">=&gt;</span> <span class="nv">$FieldConfig</span><span class="p">,</span>
        <span class="n">ValidID</span>    <span class="o">=&gt;</span> <span class="nv">$GetParam</span><span class="p">{</span><span class="n">ValidID</span><span class="p">},</span>
        <span class="n">UserID</span>     <span class="o">=&gt;</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">UserID</span><span class="p">},</span>
    <span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nv">$FieldID</span> <span class="p">)</span> <span class="p">{</span>

        <span class="k">return</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">LayoutObject</span><span class="p">}</span><span class="o">-&gt;</span><span class="n">ErrorScreen</span><span class="p">(</span>
            <span class="n">Message</span> <span class="o">=&gt;</span> <span class="s">&quot;Could not create the new field&quot;</span><span class="p">,</span>
        <span class="p">);</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">LayoutObject</span><span class="p">}</span><span class="o">-&gt;</span><span class="n">Redirect</span><span class="p">(</span>
        <span class="n">OP</span> <span class="o">=&gt;</span> <span class="s">&quot;Action=AdminDynamicField&quot;</span><span class="p">,</span>
    <span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">_AddAction</span></code> function gets the configuration parameters from a new dynamic field, and it validates that the dynamic field name only contains letters and numbers. This function could validate any other parameter.</p>
<p><code class="docutils literal notranslate"><span class="pre">Name</span></code>, <code class="docutils literal notranslate"><span class="pre">Label</span></code>, <code class="docutils literal notranslate"><span class="pre">FieldOrder</span></code>, <code class="docutils literal notranslate"><span class="pre">Validity</span></code> are common parameters for all dynamic fields and they are required. Each dynamic field has its specific configuration that must contain at least the <code class="docutils literal notranslate"><span class="pre">DefaultValue</span></code>
parameter. In this case it also have <code class="docutils literal notranslate"><span class="pre">ShowValue</span></code> and <code class="docutils literal notranslate"><span class="pre">ValueMask</span></code> parameters for password field.</p>
<p>If the field has the ability to store a fixed list of values they should be stored in the <code class="docutils literal notranslate"><span class="pre">PossibleValues</span></code> parameter inside the specific configuration hash.</p>
<p>As in other admin modules, if a parameter is not valid this function returns to the add screen highlighting the erroneous form fields.</p>
<p>If all the parameters are correct it creates a new dynamic field.</p>
<div class="highlight-Perl notranslate"><div class="highlight"><pre><span></span><span class="k">sub</span> <span class="nf">_Change</span> <span class="p">{</span>
    <span class="k">my</span> <span class="p">(</span> <span class="nv">$Self</span><span class="p">,</span> <span class="nv">%Param</span> <span class="p">)</span> <span class="o">=</span> <span class="nv">@_</span><span class="p">;</span>

    <span class="k">my</span> <span class="nv">%GetParam</span><span class="p">;</span>
    <span class="k">for</span> <span class="k">my</span> <span class="nv">$Needed</span> <span class="p">(</span><span class="sx">qw(ObjectType FieldType)</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$GetParam</span><span class="p">{</span><span class="nv">$Needed</span><span class="p">}</span> <span class="o">=</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">ParamObject</span><span class="p">}</span><span class="o">-&gt;</span><span class="n">GetParam</span><span class="p">(</span> <span class="n">Param</span> <span class="o">=&gt;</span> <span class="nv">$Needed</span> <span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nv">$Needed</span> <span class="p">)</span> <span class="p">{</span>

            <span class="k">return</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">LayoutObject</span><span class="p">}</span><span class="o">-&gt;</span><span class="n">ErrorScreen</span><span class="p">(</span>
                <span class="n">Message</span> <span class="o">=&gt;</span> <span class="s">&quot;Need $Needed&quot;</span><span class="p">,</span>
            <span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1"># get the object type and field type display name</span>
    <span class="k">my</span> <span class="nv">$ObjectTypeName</span> <span class="o">=</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">ObjectTypeConfig</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span> <span class="nv">$GetParam</span><span class="p">{</span><span class="n">ObjectType</span><span class="p">}</span> <span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">DisplayName</span><span class="p">}</span> <span class="o">||</span> <span class="s">&#39;&#39;</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$FieldTypeName</span>  <span class="o">=</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">FieldTypeConfig</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span> <span class="nv">$GetParam</span><span class="p">{</span><span class="n">FieldType</span><span class="p">}</span> <span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">DisplayName</span><span class="p">}</span>   <span class="o">||</span> <span class="s">&#39;&#39;</span><span class="p">;</span>

    <span class="k">my</span> <span class="nv">$FieldID</span> <span class="o">=</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">ParamObject</span><span class="p">}</span><span class="o">-&gt;</span><span class="n">GetParam</span><span class="p">(</span> <span class="n">Param</span> <span class="o">=&gt;</span> <span class="s">&#39;ID&#39;</span> <span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nv">$FieldID</span> <span class="p">)</span> <span class="p">{</span>

        <span class="k">return</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">LayoutObject</span><span class="p">}</span><span class="o">-&gt;</span><span class="n">ErrorScreen</span><span class="p">(</span>
            <span class="n">Message</span> <span class="o">=&gt;</span> <span class="s">&quot;Need ID&quot;</span><span class="p">,</span>
        <span class="p">);</span>
    <span class="p">}</span>

    <span class="c1"># get dynamic field data</span>
    <span class="k">my</span> <span class="nv">$DynamicFieldData</span> <span class="o">=</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">DynamicFieldObject</span><span class="p">}</span><span class="o">-&gt;</span><span class="n">DynamicFieldGet</span><span class="p">(</span>
        <span class="n">ID</span> <span class="o">=&gt;</span> <span class="nv">$FieldID</span><span class="p">,</span>
    <span class="p">);</span>

    <span class="c1"># check for valid dynamic field configuration</span>
    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">IsHashRefWithData</span><span class="p">(</span><span class="nv">$DynamicFieldData</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span>

        <span class="k">return</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">LayoutObject</span><span class="p">}</span><span class="o">-&gt;</span><span class="n">ErrorScreen</span><span class="p">(</span>
            <span class="n">Message</span> <span class="o">=&gt;</span> <span class="s">&quot;Could not get data for dynamic field $FieldID&quot;</span><span class="p">,</span>
        <span class="p">);</span>
    <span class="p">}</span>

    <span class="k">my</span> <span class="nv">%Config</span> <span class="o">=</span> <span class="p">();</span>

    <span class="c1"># extract configuration</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">IsHashRefWithData</span><span class="p">(</span> <span class="nv">$DynamicFieldData</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">Config</span><span class="p">}</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
        <span class="nv">%Config</span> <span class="o">=</span> <span class="nv">%</span><span class="p">{</span> <span class="nv">$DynamicFieldData</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">Config</span><span class="p">}</span> <span class="p">};</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="n">_ShowScreen</span><span class="p">(</span>
        <span class="nv">%Param</span><span class="p">,</span>
        <span class="nv">%GetParam</span><span class="p">,</span>
        <span class="nv">%$</span><span class="p">{</span><span class="n">DynamicFieldData</span><span class="p">},</span>
        <span class="nv">%Config</span><span class="p">,</span>
        <span class="n">ID</span>             <span class="o">=&gt;</span> <span class="nv">$FieldID</span><span class="p">,</span>
        <span class="n">Mode</span>           <span class="o">=&gt;</span> <span class="s">&#39;Change&#39;</span><span class="p">,</span>
        <span class="n">ObjectTypeName</span> <span class="o">=&gt;</span> <span class="nv">$ObjectTypeName</span><span class="p">,</span>
        <span class="n">FieldTypeName</span>  <span class="o">=&gt;</span> <span class="nv">$FieldTypeName</span><span class="p">,</span>
    <span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">_Change</span></code> function is very similar to the <code class="docutils literal notranslate"><span class="pre">_Add</span></code> function but since this function is used to edit an existing field it needs to validated the <code class="docutils literal notranslate"><span class="pre">FieldID</span></code> parameter and gather the current dynamic field data.</p>
<div class="highlight-Perl notranslate"><div class="highlight"><pre><span></span><span class="k">sub</span> <span class="nf">_ChangeAction</span> <span class="p">{</span>
    <span class="k">my</span> <span class="p">(</span> <span class="nv">$Self</span><span class="p">,</span> <span class="nv">%Param</span> <span class="p">)</span> <span class="o">=</span> <span class="nv">@_</span><span class="p">;</span>

    <span class="k">my</span> <span class="nv">%Errors</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">%GetParam</span><span class="p">;</span>

    <span class="k">for</span> <span class="k">my</span> <span class="nv">$Needed</span> <span class="p">(</span><span class="sx">qw(Name Label FieldOrder)</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$GetParam</span><span class="p">{</span><span class="nv">$Needed</span><span class="p">}</span> <span class="o">=</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">ParamObject</span><span class="p">}</span><span class="o">-&gt;</span><span class="n">GetParam</span><span class="p">(</span> <span class="n">Param</span> <span class="o">=&gt;</span> <span class="nv">$Needed</span> <span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nv">$GetParam</span><span class="p">{</span><span class="nv">$Needed</span><span class="p">}</span> <span class="p">)</span> <span class="p">{</span>
            <span class="nv">$Errors</span><span class="p">{</span> <span class="nv">$Needed</span> <span class="o">.</span> <span class="s">&#39;ServerError&#39;</span> <span class="p">}</span>        <span class="o">=</span> <span class="s">&#39;ServerError&#39;</span><span class="p">;</span>
            <span class="nv">$Errors</span><span class="p">{</span> <span class="nv">$Needed</span> <span class="o">.</span> <span class="s">&#39;ServerErrorMessage&#39;</span> <span class="p">}</span> <span class="o">=</span> <span class="s">&#39;This field is required.&#39;</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">my</span> <span class="nv">$FieldID</span> <span class="o">=</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">ParamObject</span><span class="p">}</span><span class="o">-&gt;</span><span class="n">GetParam</span><span class="p">(</span> <span class="n">Param</span> <span class="o">=&gt;</span> <span class="s">&#39;ID&#39;</span> <span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nv">$FieldID</span> <span class="p">)</span> <span class="p">{</span>

        <span class="k">return</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">LayoutObject</span><span class="p">}</span><span class="o">-&gt;</span><span class="n">ErrorScreen</span><span class="p">(</span>
            <span class="n">Message</span> <span class="o">=&gt;</span> <span class="s">&quot;Need ID&quot;</span><span class="p">,</span>
        <span class="p">);</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span> <span class="nv">$GetParam</span><span class="p">{</span><span class="n">Name</span><span class="p">}</span> <span class="p">)</span> <span class="p">{</span>

        <span class="c1"># check if name is lowercase</span>
        <span class="k">if</span> <span class="p">(</span> <span class="nv">$GetParam</span><span class="p">{</span><span class="n">Name</span><span class="p">}</span> <span class="o">!~</span> <span class="sr">m{\A ( ?: [a-zA-Z] | \d )+ \z}xms</span> <span class="p">)</span> <span class="p">{</span>

            <span class="c1"># add server error error class</span>
            <span class="nv">$Errors</span><span class="p">{</span><span class="n">NameServerError</span><span class="p">}</span> <span class="o">=</span> <span class="s">&#39;ServerError&#39;</span><span class="p">;</span>
            <span class="nv">$Errors</span><span class="p">{</span><span class="n">NameServerErrorMessage</span><span class="p">}</span> <span class="o">=</span>
                <span class="s">&#39;The field does not contain only ASCII letters and numbers.&#39;</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="c1"># check if name is duplicated</span>
        <span class="k">my</span> <span class="nv">%DynamicFieldsList</span> <span class="o">=</span> <span class="nv">%</span><span class="p">{</span>
            <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">DynamicFieldObject</span><span class="p">}</span><span class="o">-&gt;</span><span class="n">DynamicFieldList</span><span class="p">(</span>
                <span class="n">Valid</span>      <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">ResultType</span> <span class="o">=&gt;</span> <span class="s">&#39;HASH&#39;</span><span class="p">,</span>
                <span class="p">)</span>
        <span class="p">};</span>

        <span class="nv">%DynamicFieldsList</span> <span class="o">=</span> <span class="nb">reverse</span> <span class="nv">%DynamicFieldsList</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="nv">$DynamicFieldsList</span><span class="p">{</span> <span class="nv">$GetParam</span><span class="p">{</span><span class="n">Name</span><span class="p">}</span> <span class="p">}</span> <span class="o">&amp;&amp;</span>
            <span class="nv">$DynamicFieldsList</span><span class="p">{</span> <span class="nv">$GetParam</span><span class="p">{</span><span class="n">Name</span><span class="p">}</span> <span class="p">}</span> <span class="ow">ne</span> <span class="nv">$FieldID</span>
            <span class="p">)</span>
        <span class="p">{</span>

            <span class="c1"># add server error class</span>
            <span class="nv">$Errors</span><span class="p">{</span><span class="n">NameServerError</span><span class="p">}</span>        <span class="o">=</span> <span class="s">&#39;ServerError&#39;</span><span class="p">;</span>
            <span class="nv">$Errors</span><span class="p">{</span><span class="n">NameServerErrorMessage</span><span class="p">}</span> <span class="o">=</span> <span class="s">&#39;There is another field with the same name.&#39;</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span> <span class="nv">$GetParam</span><span class="p">{</span><span class="n">FieldOrder</span><span class="p">}</span> <span class="p">)</span> <span class="p">{</span>

        <span class="c1"># check if field order is numeric and positive</span>
        <span class="k">if</span> <span class="p">(</span> <span class="nv">$GetParam</span><span class="p">{</span><span class="n">FieldOrder</span><span class="p">}</span> <span class="o">!~</span> <span class="sr">m{\A ( ?: \d )+ \z}xms</span> <span class="p">)</span> <span class="p">{</span>

            <span class="c1"># add server error error class</span>
            <span class="nv">$Errors</span><span class="p">{</span><span class="n">FieldOrderServerError</span><span class="p">}</span>        <span class="o">=</span> <span class="s">&#39;ServerError&#39;</span><span class="p">;</span>
            <span class="nv">$Errors</span><span class="p">{</span><span class="n">FieldOrderServerErrorMessage</span><span class="p">}</span> <span class="o">=</span> <span class="s">&#39;The field must be numeric.&#39;</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">for</span> <span class="k">my</span> <span class="nv">$ConfigParam</span> <span class="p">(</span>
        <span class="sx">qw(</span>
<span class="sx">        ObjectType ObjectTypeName FieldType FieldTypeName DefaultValue ValidID ShowValue</span>
<span class="sx">        ValueMask</span>
<span class="sx">        )</span>
        <span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$GetParam</span><span class="p">{</span><span class="nv">$ConfigParam</span><span class="p">}</span> <span class="o">=</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">ParamObject</span><span class="p">}</span><span class="o">-&gt;</span><span class="n">GetParam</span><span class="p">(</span> <span class="n">Param</span> <span class="o">=&gt;</span> <span class="nv">$ConfigParam</span> <span class="p">);</span>
    <span class="p">}</span>

    <span class="c1"># uncorrectable errors</span>
    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nv">$GetParam</span><span class="p">{</span><span class="n">ValidID</span><span class="p">}</span> <span class="p">)</span> <span class="p">{</span>

        <span class="k">return</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">LayoutObject</span><span class="p">}</span><span class="o">-&gt;</span><span class="n">ErrorScreen</span><span class="p">(</span>
            <span class="n">Message</span> <span class="o">=&gt;</span> <span class="s">&quot;Need ValidID&quot;</span><span class="p">,</span>
        <span class="p">);</span>
    <span class="p">}</span>

    <span class="c1"># get dynamic field data</span>
    <span class="k">my</span> <span class="nv">$DynamicFieldData</span> <span class="o">=</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">DynamicFieldObject</span><span class="p">}</span><span class="o">-&gt;</span><span class="n">DynamicFieldGet</span><span class="p">(</span>
        <span class="n">ID</span> <span class="o">=&gt;</span> <span class="nv">$FieldID</span><span class="p">,</span>
    <span class="p">);</span>

    <span class="c1"># check for valid dynamic field configuration</span>
    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">IsHashRefWithData</span><span class="p">(</span><span class="nv">$DynamicFieldData</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span>

        <span class="k">return</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">LayoutObject</span><span class="p">}</span><span class="o">-&gt;</span><span class="n">ErrorScreen</span><span class="p">(</span>
            <span class="n">Message</span> <span class="o">=&gt;</span> <span class="s">&quot;Could not get data for dynamic field $FieldID&quot;</span><span class="p">,</span>
        <span class="p">);</span>
    <span class="p">}</span>

    <span class="c1"># return to change screen if errors</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">%Errors</span><span class="p">)</span> <span class="p">{</span>

        <span class="k">return</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="n">_ShowScreen</span><span class="p">(</span>
            <span class="nv">%Param</span><span class="p">,</span>
            <span class="nv">%Errors</span><span class="p">,</span>
            <span class="nv">%GetParam</span><span class="p">,</span>
            <span class="n">ID</span>   <span class="o">=&gt;</span> <span class="nv">$FieldID</span><span class="p">,</span>
            <span class="n">Mode</span> <span class="o">=&gt;</span> <span class="s">&#39;Change&#39;</span><span class="p">,</span>
        <span class="p">);</span>
    <span class="p">}</span>

    <span class="c1"># set specific config</span>
    <span class="k">my</span> <span class="nv">$FieldConfig</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">DefaultValue</span> <span class="o">=&gt;</span> <span class="nv">$GetParam</span><span class="p">{</span><span class="n">DefaultValue</span><span class="p">},</span>
        <span class="n">ShowValue</span>    <span class="o">=&gt;</span> <span class="nv">$GetParam</span><span class="p">{</span><span class="n">ShowValue</span><span class="p">},</span>
        <span class="n">ValueMask</span>    <span class="o">=&gt;</span> <span class="nv">$GetParam</span><span class="p">{</span><span class="n">ValueMask</span><span class="p">},</span>
    <span class="p">};</span>

    <span class="c1"># update dynamic field (FieldType and ObjectType cannot be changed; use old values)</span>
    <span class="k">my</span> <span class="nv">$UpdateSuccess</span> <span class="o">=</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">DynamicFieldObject</span><span class="p">}</span><span class="o">-&gt;</span><span class="n">DynamicFieldUpdate</span><span class="p">(</span>
        <span class="n">ID</span>         <span class="o">=&gt;</span> <span class="nv">$FieldID</span><span class="p">,</span>
        <span class="n">Name</span>       <span class="o">=&gt;</span> <span class="nv">$GetParam</span><span class="p">{</span><span class="n">Name</span><span class="p">},</span>
        <span class="n">Label</span>      <span class="o">=&gt;</span> <span class="nv">$GetParam</span><span class="p">{</span><span class="n">Label</span><span class="p">},</span>
        <span class="n">FieldOrder</span> <span class="o">=&gt;</span> <span class="nv">$GetParam</span><span class="p">{</span><span class="n">FieldOrder</span><span class="p">},</span>
        <span class="n">FieldType</span>  <span class="o">=&gt;</span> <span class="nv">$DynamicFieldData</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">FieldType</span><span class="p">},</span>
        <span class="n">ObjectType</span> <span class="o">=&gt;</span> <span class="nv">$DynamicFieldData</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">ObjectType</span><span class="p">},</span>
        <span class="n">Config</span>     <span class="o">=&gt;</span> <span class="nv">$FieldConfig</span><span class="p">,</span>
        <span class="n">ValidID</span>    <span class="o">=&gt;</span> <span class="nv">$GetParam</span><span class="p">{</span><span class="n">ValidID</span><span class="p">},</span>
        <span class="n">UserID</span>     <span class="o">=&gt;</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">UserID</span><span class="p">},</span>
    <span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nv">$UpdateSuccess</span> <span class="p">)</span> <span class="p">{</span>

        <span class="k">return</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">LayoutObject</span><span class="p">}</span><span class="o">-&gt;</span><span class="n">ErrorScreen</span><span class="p">(</span>
            <span class="n">Message</span> <span class="o">=&gt;</span> <span class="s">&quot;Could not update the field $GetParam{Name}&quot;</span><span class="p">,</span>
        <span class="p">);</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">LayoutObject</span><span class="p">}</span><span class="o">-&gt;</span><span class="n">Redirect</span><span class="p">(</span>
        <span class="n">OP</span> <span class="o">=&gt;</span> <span class="s">&quot;Action=AdminDynamicField&quot;</span><span class="p">,</span>
    <span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">_ChangeAction()</span></code> is very similar to <code class="docutils literal notranslate"><span class="pre">_AddAction()</span></code>, but adapted for the update of an existing field instead of creating a new one.</p>
<div class="highlight-Perl notranslate"><div class="highlight"><pre><span></span><span class="k">sub</span> <span class="nf">_ShowScreen</span> <span class="p">{</span>
    <span class="k">my</span> <span class="p">(</span> <span class="nv">$Self</span><span class="p">,</span> <span class="nv">%Param</span> <span class="p">)</span> <span class="o">=</span> <span class="nv">@_</span><span class="p">;</span>

    <span class="nv">$Param</span><span class="p">{</span><span class="n">DisplayFieldName</span><span class="p">}</span> <span class="o">=</span> <span class="s">&#39;New&#39;</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span> <span class="nv">$Param</span><span class="p">{</span><span class="n">Mode</span><span class="p">}</span> <span class="ow">eq</span> <span class="s">&#39;Change&#39;</span> <span class="p">)</span> <span class="p">{</span>
        <span class="nv">$Param</span><span class="p">{</span><span class="n">ShowWarning</span><span class="p">}</span>      <span class="o">=</span> <span class="s">&#39;ShowWarning&#39;</span><span class="p">;</span>
        <span class="nv">$Param</span><span class="p">{</span><span class="n">DisplayFieldName</span><span class="p">}</span> <span class="o">=</span> <span class="nv">$Param</span><span class="p">{</span><span class="n">Name</span><span class="p">};</span>
    <span class="p">}</span>

    <span class="c1"># header</span>
    <span class="k">my</span> <span class="nv">$Output</span> <span class="o">=</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">LayoutObject</span><span class="p">}</span><span class="o">-&gt;</span><span class="n">Header</span><span class="p">();</span>
    <span class="nv">$Output</span> <span class="o">.=</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">LayoutObject</span><span class="p">}</span><span class="o">-&gt;</span><span class="n">NavigationBar</span><span class="p">();</span>

    <span class="c1"># get all fields</span>
    <span class="k">my</span> <span class="nv">$DynamicFieldList</span> <span class="o">=</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">DynamicFieldObject</span><span class="p">}</span><span class="o">-&gt;</span><span class="n">DynamicFieldListGet</span><span class="p">(</span>
        <span class="n">Valid</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">);</span>

    <span class="c1"># get the list of order numbers (is already sorted).</span>
    <span class="k">my</span> <span class="nv">@DynamicfieldOrderList</span><span class="p">;</span>
    <span class="k">for</span> <span class="k">my</span> <span class="nv">$Dynamicfield</span> <span class="p">(</span> <span class="nv">@</span><span class="p">{</span><span class="nv">$DynamicFieldList</span><span class="p">}</span> <span class="p">)</span> <span class="p">{</span>
        <span class="nb">push</span> <span class="nv">@DynamicfieldOrderList</span><span class="p">,</span> <span class="nv">$Dynamicfield</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">FieldOrder</span><span class="p">};</span>
    <span class="p">}</span>

    <span class="c1"># when adding we need to create an extra order number for the new field</span>
    <span class="k">if</span> <span class="p">(</span> <span class="nv">$Param</span><span class="p">{</span><span class="n">Mode</span><span class="p">}</span> <span class="ow">eq</span> <span class="s">&#39;Add&#39;</span> <span class="p">)</span> <span class="p">{</span>

        <span class="c1"># get the last element from the order list and add 1</span>
        <span class="k">my</span> <span class="nv">$LastOrderNumber</span> <span class="o">=</span> <span class="nv">$DynamicfieldOrderList</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>
        <span class="nv">$LastOrderNumber</span><span class="o">++</span><span class="p">;</span>

        <span class="c1"># add this new order number to the end of the list</span>
        <span class="nb">push</span> <span class="nv">@DynamicfieldOrderList</span><span class="p">,</span> <span class="nv">$LastOrderNumber</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">my</span> <span class="nv">$DynamicFieldOrderSrtg</span> <span class="o">=</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">LayoutObject</span><span class="p">}</span><span class="o">-&gt;</span><span class="n">BuildSelection</span><span class="p">(</span>
        <span class="n">Data</span>          <span class="o">=&gt;</span> <span class="o">\</span><span class="nv">@DynamicfieldOrderList</span><span class="p">,</span>
        <span class="n">Name</span>          <span class="o">=&gt;</span> <span class="s">&#39;FieldOrder&#39;</span><span class="p">,</span>
        <span class="n">SelectedValue</span> <span class="o">=&gt;</span> <span class="nv">$Param</span><span class="p">{</span><span class="n">FieldOrder</span><span class="p">}</span> <span class="o">||</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">PossibleNone</span>  <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">Class</span>         <span class="o">=&gt;</span> <span class="s">&#39;W50pc Validate_Number&#39;</span><span class="p">,</span>
    <span class="p">);</span>

    <span class="k">my</span> <span class="nv">%ValidList</span> <span class="o">=</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">ValidObject</span><span class="p">}</span><span class="o">-&gt;</span><span class="n">ValidList</span><span class="p">();</span>

    <span class="c1"># create the Validity select</span>
    <span class="k">my</span> <span class="nv">$ValidityStrg</span> <span class="o">=</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">LayoutObject</span><span class="p">}</span><span class="o">-&gt;</span><span class="n">BuildSelection</span><span class="p">(</span>
        <span class="n">Data</span>         <span class="o">=&gt;</span> <span class="o">\</span><span class="nv">%ValidList</span><span class="p">,</span>
        <span class="n">Name</span>         <span class="o">=&gt;</span> <span class="s">&#39;ValidID&#39;</span><span class="p">,</span>
        <span class="n">SelectedID</span>   <span class="o">=&gt;</span> <span class="nv">$Param</span><span class="p">{</span><span class="n">ValidID</span><span class="p">}</span> <span class="o">||</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">PossibleNone</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">Translation</span>  <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">Class</span>        <span class="o">=&gt;</span> <span class="s">&#39;W50pc&#39;</span><span class="p">,</span>
    <span class="p">);</span>

    <span class="c1"># define config field specific settings</span>
    <span class="k">my</span> <span class="nv">$DefaultValue</span> <span class="o">=</span> <span class="p">(</span> <span class="nb">defined</span> <span class="nv">$Param</span><span class="p">{</span><span class="n">DefaultValue</span><span class="p">}</span> <span class="p">?</span> <span class="nv">$Param</span><span class="p">{</span><span class="n">DefaultValue</span><span class="p">}</span> <span class="p">:</span> <span class="s">&#39;&#39;</span> <span class="p">);</span>

    <span class="c1"># create the Show value select</span>
    <span class="k">my</span> <span class="nv">$ShowValueStrg</span> <span class="o">=</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">LayoutObject</span><span class="p">}</span><span class="o">-&gt;</span><span class="n">BuildSelection</span><span class="p">(</span>
        <span class="n">Data</span> <span class="o">=&gt;</span> <span class="p">[</span> <span class="s">&#39;No&#39;</span><span class="p">,</span> <span class="s">&#39;Yes&#39;</span> <span class="p">],</span>
        <span class="n">Name</span> <span class="o">=&gt;</span> <span class="s">&#39;ShowValue&#39;</span><span class="p">,</span>
        <span class="n">SelectedValue</span> <span class="o">=&gt;</span> <span class="nv">$Param</span><span class="p">{</span><span class="n">ShowValue</span><span class="p">}</span> <span class="o">||</span> <span class="s">&#39;No&#39;</span><span class="p">,</span>
        <span class="n">PossibleNone</span>  <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">Translation</span>   <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">Class</span>         <span class="o">=&gt;</span> <span class="s">&#39;W50pc&#39;</span><span class="p">,</span>
    <span class="p">);</span>

    <span class="c1"># generate output</span>
    <span class="nv">$Output</span> <span class="o">.=</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">LayoutObject</span><span class="p">}</span><span class="o">-&gt;</span><span class="n">Output</span><span class="p">(</span>
        <span class="n">TemplateFile</span> <span class="o">=&gt;</span> <span class="s">&#39;AdminDynamicFieldPassword&#39;</span><span class="p">,</span>
        <span class="n">Data</span>         <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="nv">%Param</span><span class="p">,</span>
            <span class="n">ValidityStrg</span>          <span class="o">=&gt;</span> <span class="nv">$ValidityStrg</span><span class="p">,</span>
            <span class="n">DynamicFieldOrderSrtg</span> <span class="o">=&gt;</span> <span class="nv">$DynamicFieldOrderSrtg</span><span class="p">,</span>
            <span class="n">DefaultValue</span>          <span class="o">=&gt;</span> <span class="nv">$DefaultValue</span><span class="p">,</span>
            <span class="n">ShowValueStrg</span>         <span class="o">=&gt;</span> <span class="nv">$ShowValueStrg</span><span class="p">,</span>
            <span class="n">ValueMask</span>             <span class="o">=&gt;</span> <span class="nv">$Param</span><span class="p">{</span><span class="n">ValueMask</span><span class="p">}</span> <span class="o">||</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">DefaultValueMask</span><span class="p">},</span>
        <span class="p">},</span>
    <span class="p">);</span>

    <span class="nv">$Output</span> <span class="o">.=</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">LayoutObject</span><span class="p">}</span><span class="o">-&gt;</span><span class="n">Footer</span><span class="p">();</span>

    <span class="k">return</span> <span class="nv">$Output</span><span class="p">;</span>
<span class="p">}</span>

<span class="mi">1</span><span class="p">;</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">_ShowScreen</span></code> function is used to set and define the HTML elements and blocks from a template to generate the admin dialog HTML code.</p>
</div>
<div class="section" id="dynamic-field-template-for-admin-dialog-example">
<h3>Dynamic Field Template for Admin Dialog Example<a class="headerlink" href="#dynamic-field-template-for-admin-dialog-example" title="Permalink to this headline">¶</a></h3>
<p>The template is the place where the HTML code of the dialog is stored.</p>
<p>In this section an admin dialog template for the password dynamic field is shown and explained.</p>
<div class="highlight-Perl notranslate"><div class="highlight"><pre><span></span><span class="c1"># --</span>
<span class="c1"># AdminDynamicFieldPassword.tt - provides HTML form for AdminDynamicFieldPassword</span>
<span class="c1"># Copyright (C) 2001-2019 OTRS AG, https://otrs.com/</span>
<span class="c1"># --</span>
<span class="c1"># This software comes with ABSOLUTELY NO WARRANTY. For details, see</span>
<span class="c1"># the enclosed file COPYING for license information (GPL). If you</span>
<span class="c1"># did not receive this file, see https://www.gnu.org/licenses/gpl-3.0.txt.</span>
<span class="c1"># --</span>
</pre></div>
</div>
<p>This is common header that can be found in common OTRS modules.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;div class=&quot;MainBox ARIARoleMain LayoutFixedSidebar SidebarFirst&quot;&gt;
    &lt;h1&gt;[% Translate(&quot;Dynamic Fields&quot;) | html %] - [% Translate(Data.ObjectTypeName) | html %]: [% Translate(Data.Mode) | html %] [% Translate(Data.FieldTypeName) | html %] [% Translate(&quot;Field&quot;) | html %]&lt;/h1&gt;

    &lt;div class=&quot;Clear&quot;&gt;&lt;/div&gt;

    &lt;div class=&quot;SidebarColumn&quot;&gt;
        &lt;div class=&quot;WidgetSimple&quot;&gt;
            &lt;div class=&quot;Header&quot;&gt;
                &lt;h2&gt;[% Translate(&quot;Actions&quot;) | html %]&lt;/h2&gt;
            &lt;/div&gt;
            &lt;div class=&quot;Content&quot;&gt;
                &lt;ul class=&quot;ActionList&quot;&gt;
                    &lt;li&gt;
                        &lt;a href=&quot;[% Env(&quot;Baselink&quot;) %]Action=AdminDynamicField&quot; class=&quot;CallForAction&quot;&gt;&lt;span&gt;[% Translate(&quot;Go back to overview&quot;) | html %]&lt;/span&gt;&lt;/a&gt;
                    &lt;/li&gt;
                &lt;/ul&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
</pre></div>
</div>
<p>This part of the code has the main box and also the actions side bar. No modifications are needed in this section.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;div class=&quot;ContentColumn&quot;&gt;
    &lt;form action=&quot;[% Env(&quot;CGIHandle&quot;) %]&quot; method=&quot;post&quot; class=&quot;Validate PreventMultipleSubmits&quot;&gt;
        &lt;input type=&quot;hidden&quot; name=&quot;Action&quot; value=&quot;AdminDynamicFieldPassword&quot; /&gt;
        &lt;input type=&quot;hidden&quot; name=&quot;Subaction&quot; value=&quot;[% Data.Mode | html %]Action&quot; /&gt;
        &lt;input type=&quot;hidden&quot; name=&quot;ObjectType&quot; value=&quot;[% Data.ObjectType | html %]&quot; /&gt;
        &lt;input type=&quot;hidden&quot; name=&quot;FieldType&quot; value=&quot;[% Data.FieldType | html %]&quot; /&gt;
        &lt;input type=&quot;hidden&quot; name=&quot;ID&quot; value=&quot;[% Data.ID | html %]&quot; /&gt;
</pre></div>
</div>
<p>In this section of the code is defined the right part of the dialog. Notice that the value of the <code class="docutils literal notranslate"><span class="pre">Action</span></code> hidden input must match with the name of the admin dialog.</p>
<div class="highlight-HTML notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;WidgetSimple&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;Header&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span>[% Translate(&quot;General&quot;) | html %]<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;Content&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;LayoutGrid ColumnsWithSpacing&quot;</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;Size1of2&quot;</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nt">fieldset</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;TableLike&quot;</span><span class="p">&gt;</span>
                    <span class="p">&lt;</span><span class="nt">label</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;Mandatory&quot;</span> <span class="na">for</span><span class="o">=</span><span class="s">&quot;Name&quot;</span><span class="p">&gt;&lt;</span><span class="nt">span</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;Marker&quot;</span><span class="p">&gt;</span>*<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span> [% Translate(&quot;Name&quot;) | html %]:<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
                    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;Field&quot;</span><span class="p">&gt;</span>
                        <span class="p">&lt;</span><span class="nt">input</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;Name&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;W50pc [% Data.NameServerError | html %] [% Data.ShowWarning | html %]  Validate_Alphanumeric&quot;</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span> <span class="na">maxlength</span><span class="o">=</span><span class="s">&quot;200&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;[% Data.Name | html %]&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;Name&quot;</span><span class="p">/&gt;</span>
                        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;NameError&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;TooltipErrorMessage&quot;</span><span class="p">&gt;&lt;</span><span class="nt">p</span><span class="p">&gt;</span>[% Translate(&quot;This field is required, and the value should be alphabetic and numeric characters only.&quot;) | html %]<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
                        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;NameServerError&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;TooltipErrorMessage&quot;</span><span class="p">&gt;&lt;</span><span class="nt">p</span><span class="p">&gt;</span>[% Translate(Data.NameServerErrorMessage) | html %]<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
                        <span class="p">&lt;</span><span class="nt">p</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;FieldExplanation&quot;</span><span class="p">&gt;</span>[% Translate(&quot;Must be unique and only accept alphabetic and numeric characters.&quot;) | html %]<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
                        <span class="p">&lt;</span><span class="nt">p</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;Warning Hidden&quot;</span><span class="p">&gt;</span>[% Translate(&quot;Changing this value will require manual changes in the system.&quot;) | html %]<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
                    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
                    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;Clear&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

                    <span class="p">&lt;</span><span class="nt">label</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;Mandatory&quot;</span> <span class="na">for</span><span class="o">=</span><span class="s">&quot;Label&quot;</span><span class="p">&gt;&lt;</span><span class="nt">span</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;Marker&quot;</span><span class="p">&gt;</span>*<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span> [% Translate(&quot;Label&quot;) | html %]:<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
                    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;Field&quot;</span><span class="p">&gt;</span>
                        <span class="p">&lt;</span><span class="nt">input</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;Label&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;W50pc [% Data.LabelServerError | html %] Validate_Required&quot;</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span> <span class="na">maxlength</span><span class="o">=</span><span class="s">&quot;200&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;[% Data.Label | html %]&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;Label&quot;</span><span class="p">/&gt;</span>
                        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;LabelError&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;TooltipErrorMessage&quot;</span><span class="p">&gt;&lt;</span><span class="nt">p</span><span class="p">&gt;</span>[% Translate(&quot;This field is required.&quot;) | html %]<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
                        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;LabelServerError&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;TooltipErrorMessage&quot;</span><span class="p">&gt;&lt;</span><span class="nt">p</span><span class="p">&gt;</span>[% Translate(Data.LabelServerErrorMessage) | html %]<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
                        <span class="p">&lt;</span><span class="nt">p</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;FieldExplanation&quot;</span><span class="p">&gt;</span>[% Translate(&quot;This is the name to be shown on the screens where the field is active.&quot;) | html %]<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
                    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
                    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;Clear&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

                    <span class="p">&lt;</span><span class="nt">label</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;Mandatory&quot;</span> <span class="na">for</span><span class="o">=</span><span class="s">&quot;FieldOrder&quot;</span><span class="p">&gt;&lt;</span><span class="nt">span</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;Marker&quot;</span><span class="p">&gt;</span>*<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span> [% Translate(&quot;Field order&quot;) | html %]:<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
                    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;Field&quot;</span><span class="p">&gt;</span>
                        [% Data.DynamicFieldOrderSrtg %]
                        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;FieldOrderError&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;TooltipErrorMessage&quot;</span><span class="p">&gt;&lt;</span><span class="nt">p</span><span class="p">&gt;</span>[% Translate(&quot;This field is required and must be numeric.&quot;) | html %]<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
                        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;FieldOrderServerError&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;TooltipErrorMessage&quot;</span><span class="p">&gt;&lt;</span><span class="nt">p</span><span class="p">&gt;</span>[% Translate(Data.FieldOrderServerErrorMessage) | html %]<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
                        <span class="p">&lt;</span><span class="nt">p</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;FieldExplanation&quot;</span><span class="p">&gt;</span>[% Translate(&quot;This is the order in which this field will be shown on the screens where is active.&quot;) | html %]<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
                    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
                    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;Clear&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
                <span class="p">&lt;/</span><span class="nt">fieldset</span><span class="p">&gt;</span>
            <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;Size1of2&quot;</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nt">fieldset</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;TableLike&quot;</span><span class="p">&gt;</span>
                    <span class="p">&lt;</span><span class="nt">label</span> <span class="na">for</span><span class="o">=</span><span class="s">&quot;ValidID&quot;</span><span class="p">&gt;</span>[% Translate(&quot;Validity&quot;) | html %]:<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
                    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;Field&quot;</span><span class="p">&gt;</span>
                        [% Data.ValidityStrg %]
                    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
                    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;Clear&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

                    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;SpacingTop&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
                    <span class="p">&lt;</span><span class="nt">label</span> <span class="na">for</span><span class="o">=</span><span class="s">&quot;FieldTypeName&quot;</span><span class="p">&gt;</span>[% Translate(&quot;Field type&quot;) | html %]:<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
                    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;Field&quot;</span><span class="p">&gt;</span>
                        <span class="p">&lt;</span><span class="nt">input</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;FieldTypeName&quot;</span> <span class="na">readonly</span><span class="o">=</span><span class="s">&quot;readonly&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;W50pc&quot;</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span> <span class="na">maxlength</span><span class="o">=</span><span class="s">&quot;200&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;[% Data.FieldTypeName | html %]&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;FieldTypeName&quot;</span><span class="p">/&gt;</span>
                        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;Clear&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
                    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

                    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;SpacingTop&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
                    <span class="p">&lt;</span><span class="nt">label</span> <span class="na">for</span><span class="o">=</span><span class="s">&quot;ObjectTypeName&quot;</span><span class="p">&gt;</span>[% Translate(&quot;Object type&quot;) | html %]:<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
                    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;Field&quot;</span><span class="p">&gt;</span>
                        <span class="p">&lt;</span><span class="nt">input</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;ObjectTypeName&quot;</span> <span class="na">readonly</span><span class="o">=</span><span class="s">&quot;readonly&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;W50pc&quot;</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span> <span class="na">maxlength</span><span class="o">=</span><span class="s">&quot;200&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;[% Data.ObjectTypeName | html %]&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;ObjectTypeName&quot;</span><span class="p">/&gt;</span>
                        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;Clear&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
                    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
                <span class="p">&lt;/</span><span class="nt">fieldset</span><span class="p">&gt;</span>
            <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>This first widget contains the common form attributes for the dynamic fields. For consistency with other dynamic fields is recommended to leave this part of the code unchanged.</p>
<div class="highlight-HTML notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;WidgetSimple&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;Header&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span>[% Translate(Data.FieldTypeName) | html %] [% Translate(&quot;Field Settings&quot;) | html %]<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;Content&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">fieldset</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;TableLike&quot;</span><span class="p">&gt;</span>

            <span class="p">&lt;</span><span class="nt">label</span> <span class="na">for</span><span class="o">=</span><span class="s">&quot;DefaultValue&quot;</span><span class="p">&gt;</span>[% Translate(&quot;Default value&quot;) | html %]:<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;Field&quot;</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nt">input</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;DefaultValue&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;W50pc&quot;</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span> <span class="na">maxlength</span><span class="o">=</span><span class="s">&quot;200&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;[% Data.DefaultValue | html %]&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;DefaultValue&quot;</span><span class="p">/&gt;</span>
                <span class="p">&lt;</span><span class="nt">p</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;FieldExplanation&quot;</span><span class="p">&gt;</span>[% Translate(&quot;This is the default value for this field.&quot;) | html %]<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
            <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;Clear&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

            <span class="p">&lt;</span><span class="nt">label</span> <span class="na">for</span><span class="o">=</span><span class="s">&quot;ShowValue&quot;</span><span class="p">&gt;</span>[% Translate(&quot;Show value&quot;) | html %]:<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;Field&quot;</span><span class="p">&gt;</span>
                [% Data.ShowValueStrg %]
                <span class="p">&lt;</span><span class="nt">p</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;FieldExplanation&quot;</span><span class="p">&gt;</span>
                    [% Translate(&quot;To reveal the field value in non edit screens ( e.g. Ticket Zoom Screen )&quot;) | html %]
                <span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
            <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;Clear&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

            <span class="p">&lt;</span><span class="nt">label</span> <span class="na">for</span><span class="o">=</span><span class="s">&quot;ValueMask&quot;</span><span class="p">&gt;</span>[% Translate(&quot;Hidden value mask&quot;) | html %]:<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;Field&quot;</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nt">input</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;ValueMask&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;W50pc&quot;</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span> <span class="na">maxlength</span><span class="o">=</span><span class="s">&quot;200&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;[% Data.ValueMask | html %]&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;ValueMask&quot;</span><span class="p">/&gt;</span>
                <span class="p">&lt;</span><span class="nt">p</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;FieldExplanation&quot;</span><span class="p">&gt;</span>
                    [% Translate(&quot;This is the alternate value to show if Show value is set to \&quot;No\&quot; ( Default: **** ).&quot;) | html %]
                <span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
            <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;Clear&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

        <span class="p">&lt;/</span><span class="nt">fieldset</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>The second widget has the dynamic field specific form attributes. This is the place where new attributes can be set and it could use JavaScript and AJAX technologies to make it more easy or friendly for the end user.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>            &lt;fieldset class=&quot;TableLike&quot;&gt;
                &lt;div class=&quot;Field SpacingTop&quot;&gt;
                    &lt;button type=&quot;submit&quot; class=&quot;Primary&quot; value=&quot;[% Translate(&quot;Save&quot;) | html %]&quot;&gt;[% Translate(&quot;Save&quot;) | html %]&lt;/button&gt;
                    [% Translate(&quot;or&quot;) | html %]
                    &lt;a href=&quot;[% Env(&quot;Baselink&quot;) %]Action=AdminDynamicField&quot;&gt;[% Translate(&quot;Cancel&quot;) | html %]&lt;/a&gt;
                &lt;/div&gt;
                &lt;div class=&quot;Clear&quot;&gt;&lt;/div&gt;
            &lt;/fieldset&gt;
        &lt;/form&gt;
    &lt;/div&gt;
&lt;/div&gt;
[% WRAPPER JSOnDocumentComplete %]
&lt;script type=&quot;text/javascript&quot;&gt;//&lt;![CDATA[
$(&#39;.ShowWarning&#39;).bind(&#39;change keyup&#39;, function (Event) {
    $(&#39;p.Warning&#39;).removeClass(&#39;Hidden&#39;);
});

Core.Agent.Admin.DynamicField.ValidationInit();
//]]&gt;&lt;/script&gt;
[% END %]
</pre></div>
</div>
<p>The final part of the file contains the <em>Save</em> button and the <em>Cancel</em> link, as well as other needed JavaScript code.</p>
</div>
<div class="section" id="dynamic-field-driver-example">
<h3>Dynamic Field Driver Example<a class="headerlink" href="#dynamic-field-driver-example" title="Permalink to this headline">¶</a></h3>
<p>The driver <em>represents</em> the dynamic field. It contains several functions that are used wide in the OTRS framework.</p>
<p>A driver can inherit some functions from base classes, for example the <code class="docutils literal notranslate"><span class="pre">TextArea</span></code> driver inherits most of the functions from <code class="docutils literal notranslate"><span class="pre">Base.pm</span></code> and <code class="docutils literal notranslate"><span class="pre">BaseText.pm</span></code> (<code class="docutils literal notranslate"><span class="pre">Base/Text.pm</span></code> in the new API) and it only implements the functions that requires different logic or results. The checkbox field driver only inherits from <code class="docutils literal notranslate"><span class="pre">Base.pm</span></code>, as all other functions are very different from any other base driver.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">Please refer to the Perl online documentation (POD) of the module <code class="docutils literal notranslate"><span class="pre">/Kernel/System/DynmicFieldLegacy/Backend.pm</span></code> and <code class="docutils literal notranslate"><span class="pre">/Kernel/System/DynmicFieldLegacy/Driver/Base.pm</span></code> to have the list of all attributes and possible return data for each function.</p>
</div>
<p>In this section the password dynamic field driver is shown and explained. This driver inherits some functions from <code class="docutils literal notranslate"><span class="pre">Base.pm</span></code> and <code class="docutils literal notranslate"><span class="pre">BaseText.pm</span></code> (<code class="docutils literal notranslate"><span class="pre">Base/Text.pm</span></code> in the new API) and only implements the functions that needs different results.</p>
<div class="section" id="dynamic-field-driver-example-legacy-api">
<h4>Dynamic Field Driver Example (Legacy API)<a class="headerlink" href="#dynamic-field-driver-example-legacy-api" title="Permalink to this headline">¶</a></h4>
<div class="highlight-Perl notranslate"><div class="highlight"><pre><span></span><span class="c1"># --</span>
<span class="c1"># Kernel/System/DynamicFieldLegacy/Driver/Password.pm - Driver for DynamicField Legacy Password backend</span>
<span class="c1"># Copyright (C) 2001-2019 OTRS AG, https://otrs.com/</span>
<span class="c1"># --</span>
<span class="c1"># This software comes with ABSOLUTELY NO WARRANTY. For details, see</span>
<span class="c1"># the enclosed file COPYING for license information (GPL). If you</span>
<span class="c1"># did not receive this file, see https://www.gnu.org/licenses/gpl-3.0.txt.</span>
<span class="c1"># --</span>

<span class="k">package</span> <span class="nn">Kernel::System::DynamicFieldLegacy::Driver::Password</span><span class="p">;</span>

<span class="k">use</span> <span class="nn">strict</span><span class="p">;</span>
<span class="k">use</span> <span class="nn">warnings</span><span class="p">;</span>

<span class="k">use</span> <span class="nn">parent</span> <span class="sx">qw(Kernel::System::DynamicFieldLegacy::Driver::BaseText)</span><span class="p">;</span>

<span class="k">use</span> <span class="nn">Kernel::System::VariableCheck</span> <span class="sx">qw(:all)</span><span class="p">;</span>

<span class="k">our</span> <span class="nv">@ObjectDependencies</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s">&#39;Kernel::Config&#39;</span><span class="p">,</span>
    <span class="s">&#39;Kernel::System::DynamicFieldLegacy::Value&#39;</span><span class="p">,</span>
    <span class="s">&#39;Kernel::System::Main&#39;</span><span class="p">,</span>
<span class="p">);</span>
</pre></div>
</div>
<p>This is the common header, that can be found in common OTRS modules. The class/package name is declared via the <code class="docutils literal notranslate"><span class="pre">package</span></code> keyword. Note that <code class="docutils literal notranslate"><span class="pre">BaseText</span></code> is used as the base class.</p>
<div class="highlight-Perl notranslate"><div class="highlight"><pre><span></span><span class="k">sub</span> <span class="nf">new</span> <span class="p">{</span>
    <span class="k">my</span> <span class="p">(</span> <span class="nv">$Type</span><span class="p">,</span> <span class="nv">%Param</span> <span class="p">)</span> <span class="o">=</span> <span class="nv">@_</span><span class="p">;</span>

    <span class="c1"># allocate new hash for object</span>
    <span class="k">my</span> <span class="nv">$Self</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="nb">bless</span><span class="p">(</span> <span class="nv">$Self</span><span class="p">,</span> <span class="nv">$Type</span> <span class="p">);</span>

    <span class="c1"># set field behaviors</span>
    <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">Behaviors</span><span class="p">}</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">&#39;IsACLReducible&#39;</span>               <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s">&#39;IsNotificationEventCondition&#39;</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s">&#39;IsSortable&#39;</span>                   <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s">&#39;IsFiltrable&#39;</span>                  <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s">&#39;IsStatsCondition&#39;</span>             <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s">&#39;IsCustomerInterfaceCapable&#39;</span>   <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span>
    <span class="p">};</span>

    <span class="c1"># get the Dynamic Field Backend custom extensions</span>
    <span class="k">my</span> <span class="nv">$DynamicFieldDriverExtensions</span>
        <span class="o">=</span> <span class="nv">$</span><span class="nn">Kernel::</span><span class="nv">OM</span><span class="o">-&gt;</span><span class="n">Get</span><span class="p">(</span><span class="s">&#39;Kernel::Config&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">Get</span><span class="p">(</span><span class="s">&#39;DynamicFieldsLegacy::Extension::Driver::Password&#39;</span><span class="p">);</span>

    <span class="n">EXTENSION:</span>
    <span class="k">for</span> <span class="k">my</span> <span class="nv">$ExtensionKey</span> <span class="p">(</span> <span class="nb">sort</span> <span class="nb">keys</span> <span class="nv">%</span><span class="p">{</span><span class="nv">$DynamicFieldDriverExtensions</span><span class="p">}</span> <span class="p">)</span> <span class="p">{</span>

        <span class="c1"># skip invalid extensions</span>
        <span class="k">next</span> <span class="n">EXTENSION</span> <span class="k">if</span> <span class="o">!</span><span class="n">IsHashRefWithData</span><span class="p">(</span> <span class="nv">$DynamicFieldDriverExtensions</span><span class="o">-&gt;</span><span class="p">{</span><span class="nv">$ExtensionKey</span><span class="p">}</span> <span class="p">);</span>

        <span class="c1"># create a extension config shortcut</span>
        <span class="k">my</span> <span class="nv">$Extension</span> <span class="o">=</span> <span class="nv">$DynamicFieldDriverExtensions</span><span class="o">-&gt;</span><span class="p">{</span><span class="nv">$ExtensionKey</span><span class="p">};</span>

        <span class="c1"># check if extension has a new module</span>
        <span class="k">if</span> <span class="p">(</span> <span class="nv">$Extension</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">Module</span><span class="p">}</span> <span class="p">)</span> <span class="p">{</span>

            <span class="c1"># check if module can be loaded</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="o">!</span><span class="nv">$</span><span class="nn">Kernel::</span><span class="nv">OM</span><span class="o">-&gt;</span><span class="n">Get</span><span class="p">(</span><span class="s">&#39;Kernel::System::Main&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">RequireBaseClass</span><span class="p">(</span> <span class="nv">$Extension</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">Module</span><span class="p">}</span> <span class="p">)</span>
                <span class="p">)</span>
            <span class="p">{</span>
                <span class="nb">die</span> <span class="s">&quot;Can&#39;t load dynamic fields backend module&quot;</span>
                    <span class="o">.</span> <span class="s">&quot; $Extension-&gt;{Module}! $@&quot;</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1"># check if extension contains more behaviors</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">IsHashRefWithData</span><span class="p">(</span> <span class="nv">$Extension</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">Behaviors</span><span class="p">}</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>

            <span class="nv">%</span><span class="p">{</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">Behaviors</span><span class="p">}</span> <span class="p">}</span> <span class="o">=</span> <span class="p">(</span>
                <span class="nv">%</span><span class="p">{</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">Behaviors</span><span class="p">}</span> <span class="p">},</span>
                <span class="nv">%</span><span class="p">{</span> <span class="nv">$Extension</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">Behaviors</span><span class="p">}</span> <span class="p">}</span>
            <span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nv">$Self</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The constructor <code class="docutils literal notranslate"><span class="pre">new</span></code> creates a new instance of the class. According to the coding guidelines, objects of other classes, that are needed in this module, have to be created in subroutine <code class="docutils literal notranslate"><span class="pre">new</span></code>.</p>
<p>It is important to define the behaviors correctly, as the field might or might not be used in certain screens, functions that depends on behaviors, that are not active for this particular field, might not be needed to be implemented.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Drivers are created only by the <code class="docutils literal notranslate"><span class="pre">BackendObject</span></code> and not directly from any other module.</p>
</div>
<div class="highlight-Perl notranslate"><div class="highlight"><pre><span></span><span class="k">sub</span> <span class="nf">EditFieldRender</span> <span class="p">{</span>
    <span class="k">my</span> <span class="p">(</span> <span class="nv">$Self</span><span class="p">,</span> <span class="nv">%Param</span> <span class="p">)</span> <span class="o">=</span> <span class="nv">@_</span><span class="p">;</span>

    <span class="c1"># take config from field config</span>
    <span class="k">my</span> <span class="nv">$FieldConfig</span> <span class="o">=</span> <span class="nv">$Param</span><span class="p">{</span><span class="n">DynamicFieldConfig</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">Config</span><span class="p">};</span>
    <span class="k">my</span> <span class="nv">$FieldName</span>   <span class="o">=</span> <span class="s">&#39;DynamicField_&#39;</span> <span class="o">.</span> <span class="nv">$Param</span><span class="p">{</span><span class="n">DynamicFieldConfig</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">Name</span><span class="p">};</span>
    <span class="k">my</span> <span class="nv">$FieldLabel</span>  <span class="o">=</span> <span class="nv">$Param</span><span class="p">{</span><span class="n">DynamicFieldConfig</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">Label</span><span class="p">};</span>

    <span class="k">my</span> <span class="nv">$Value</span> <span class="o">=</span> <span class="s">&#39;&#39;</span><span class="p">;</span>

    <span class="c1"># set the field value or default</span>
    <span class="k">if</span> <span class="p">(</span> <span class="nv">$Param</span><span class="p">{</span><span class="n">UseDefaultValue</span><span class="p">}</span> <span class="p">)</span> <span class="p">{</span>
        <span class="nv">$Value</span> <span class="o">=</span> <span class="p">(</span> <span class="nb">defined</span> <span class="nv">$FieldConfig</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">DefaultValue</span><span class="p">}</span> <span class="p">?</span> <span class="nv">$FieldConfig</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">DefaultValue</span><span class="p">}</span> <span class="p">:</span> <span class="s">&#39;&#39;</span> <span class="p">);</span>
    <span class="p">}</span>
    <span class="nv">$Value</span> <span class="o">=</span> <span class="nv">$Param</span><span class="p">{</span><span class="n">Value</span><span class="p">}</span> <span class="k">if</span> <span class="nb">defined</span> <span class="nv">$Param</span><span class="p">{</span><span class="n">Value</span><span class="p">};</span>

    <span class="c1"># extract the dynamic field value from the web request</span>
    <span class="k">my</span> <span class="nv">$FieldValue</span> <span class="o">=</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="n">EditFieldValueGet</span><span class="p">(</span>
        <span class="nv">%Param</span><span class="p">,</span>
    <span class="p">);</span>

    <span class="c1"># set values from ParamObject if present</span>
    <span class="k">if</span> <span class="p">(</span> <span class="nb">defined</span> <span class="nv">$FieldValue</span> <span class="p">)</span> <span class="p">{</span>
        <span class="nv">$Value</span> <span class="o">=</span> <span class="nv">$FieldValue</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1"># check and set class if necessary</span>
    <span class="k">my</span> <span class="nv">$FieldClass</span> <span class="o">=</span> <span class="s">&#39;DynamicFieldText W50pc&#39;</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span> <span class="nb">defined</span> <span class="nv">$Param</span><span class="p">{</span><span class="n">Class</span><span class="p">}</span> <span class="o">&amp;&amp;</span> <span class="nv">$Param</span><span class="p">{</span><span class="n">Class</span><span class="p">}</span> <span class="ow">ne</span> <span class="s">&#39;&#39;</span> <span class="p">)</span> <span class="p">{</span>
        <span class="nv">$FieldClass</span> <span class="o">.=</span> <span class="s">&#39; &#39;</span> <span class="o">.</span> <span class="nv">$Param</span><span class="p">{</span><span class="n">Class</span><span class="p">};</span>
    <span class="p">}</span>

    <span class="c1"># set field as mandatory</span>
    <span class="nv">$FieldClass</span> <span class="o">.=</span> <span class="s">&#39; Validate_Required&#39;</span> <span class="k">if</span> <span class="nv">$Param</span><span class="p">{</span><span class="n">Mandatory</span><span class="p">};</span>

    <span class="c1"># set error css class</span>
    <span class="nv">$FieldClass</span> <span class="o">.=</span> <span class="s">&#39; ServerError&#39;</span> <span class="k">if</span> <span class="nv">$Param</span><span class="p">{</span><span class="n">ServerError</span><span class="p">};</span>

    <span class="k">my</span> <span class="nv">$HTMLString</span> <span class="o">=</span> <span class="s">&lt;&lt;&quot;</span><span class="dl">EOF</span><span class="s">&quot;;</span>
<span class="s">&lt;input type=&quot;password&quot; class=&quot;$FieldClass&quot; id=&quot;$FieldName&quot; name=&quot;$FieldName&quot; title=&quot;$FieldLabel&quot; value=&quot;$Value&quot; /&gt;</span>
<span class="dl">EOF</span>

    <span class="k">if</span> <span class="p">(</span> <span class="nv">$Param</span><span class="p">{</span><span class="n">Mandatory</span><span class="p">}</span> <span class="p">)</span> <span class="p">{</span>
        <span class="k">my</span> <span class="nv">$DivID</span> <span class="o">=</span> <span class="nv">$FieldName</span> <span class="o">.</span> <span class="s">&#39;Error&#39;</span><span class="p">;</span>

        <span class="c1"># for client side validation</span>
        <span class="nv">$HTMLString</span> <span class="o">.=</span> <span class="s">&lt;&lt;&quot;</span><span class="dl">EOF</span><span class="s">&quot;;</span>
<span class="s">    &lt;div id=&quot;$DivID&quot; class=&quot;TooltipErrorMessage&quot;&gt;</span>
<span class="s">        &lt;p&gt;</span>
<span class="s">            \$Text{&quot;This field is required.&quot;}</span>
<span class="s">        &lt;/p&gt;</span>
<span class="s">    &lt;/div&gt;</span>
<span class="dl">EOF</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span> <span class="nv">$Param</span><span class="p">{</span><span class="n">ServerError</span><span class="p">}</span> <span class="p">)</span> <span class="p">{</span>

        <span class="k">my</span> <span class="nv">$ErrorMessage</span> <span class="o">=</span> <span class="nv">$Param</span><span class="p">{</span><span class="n">ErrorMessage</span><span class="p">}</span> <span class="o">||</span> <span class="s">&#39;This field is required.&#39;</span><span class="p">;</span>
        <span class="k">my</span> <span class="nv">$DivID</span> <span class="o">=</span> <span class="nv">$FieldName</span> <span class="o">.</span> <span class="s">&#39;ServerError&#39;</span><span class="p">;</span>

        <span class="c1"># for server side validation</span>
        <span class="nv">$HTMLString</span> <span class="o">.=</span> <span class="s">&lt;&lt;&quot;</span><span class="dl">EOF</span><span class="s">&quot;;</span>
<span class="s">    &lt;div id=&quot;$DivID&quot; class=&quot;TooltipErrorMessage&quot;&gt;</span>
<span class="s">        &lt;p&gt;</span>
<span class="s">            \$Text{&quot;$ErrorMessage&quot;}</span>
<span class="s">        &lt;/p&gt;</span>
<span class="s">    &lt;/div&gt;</span>
<span class="dl">EOF</span>
    <span class="p">}</span>

    <span class="c1"># call EditLabelRender on the common Driver</span>
    <span class="k">my</span> <span class="nv">$LabelString</span> <span class="o">=</span> <span class="nv">$Self</span><span class="o">-&gt;</span><span class="n">EditLabelRender</span><span class="p">(</span>
        <span class="nv">%Param</span><span class="p">,</span>
        <span class="n">DynamicFieldConfig</span> <span class="o">=&gt;</span> <span class="nv">$Param</span><span class="p">{</span><span class="n">DynamicFieldConfig</span><span class="p">},</span>
        <span class="n">Mandatory</span>          <span class="o">=&gt;</span> <span class="nv">$Param</span><span class="p">{</span><span class="n">Mandatory</span><span class="p">}</span> <span class="o">||</span> <span class="s">&#39;0&#39;</span><span class="p">,</span>
        <span class="n">FieldName</span>          <span class="o">=&gt;</span> <span class="nv">$FieldName</span><span class="p">,</span>
    <span class="p">);</span>

    <span class="k">my</span> <span class="nv">$Data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">Field</span> <span class="o">=&gt;</span> <span class="nv">$HTMLString</span><span class="p">,</span>
        <span class="n">Label</span> <span class="o">=&gt;</span> <span class="nv">$LabelString</span><span class="p">,</span>
    <span class="p">};</span>

    <span class="k">return</span> <span class="nv">$Data</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This function is responsible to create the HTML representation of the field and its label. It is used in the edit screens like <code class="docutils literal notranslate"><span class="pre">AgentTicketPhone</span></code>, <code class="docutils literal notranslate"><span class="pre">AgentTicketNote</span></code>, etc.</p>
<div class="highlight-Perl notranslate"><div class="highlight"><pre><span></span><span class="k">sub</span> <span class="nf">DisplayValueRender</span> <span class="p">{</span>
    <span class="k">my</span> <span class="p">(</span> <span class="nv">$Self</span><span class="p">,</span> <span class="nv">%Param</span> <span class="p">)</span> <span class="o">=</span> <span class="nv">@_</span><span class="p">;</span>

    <span class="c1"># set HTMLOutput as default if not specified</span>
    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nb">defined</span> <span class="nv">$Param</span><span class="p">{</span><span class="n">HTMLOutput</span><span class="p">}</span> <span class="p">)</span> <span class="p">{</span>
        <span class="nv">$Param</span><span class="p">{</span><span class="n">HTMLOutput</span><span class="p">}</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">my</span> <span class="nv">$Value</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$Title</span><span class="p">;</span>

    <span class="c1"># check if field is set to show password or not</span>
    <span class="k">if</span> <span class="p">(</span>
        <span class="nb">defined</span> <span class="nv">$Param</span><span class="p">{</span><span class="n">DynamicFieldConfig</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">Config</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">ShowValue</span><span class="p">}</span>
        <span class="o">&amp;&amp;</span> <span class="nv">$Param</span><span class="p">{</span><span class="n">DynamicFieldConfig</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">Config</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">ShowValue</span><span class="p">}</span> <span class="ow">eq</span> <span class="s">&#39;Yes&#39;</span>
        <span class="p">)</span>
    <span class="p">{</span>

        <span class="c1"># get raw Title and Value strings from field value</span>
        <span class="nv">$Value</span> <span class="o">=</span> <span class="nb">defined</span> <span class="nv">$Param</span><span class="p">{</span><span class="n">Value</span><span class="p">}</span> <span class="p">?</span> <span class="nv">$Param</span><span class="p">{</span><span class="n">Value</span><span class="p">}</span> <span class="p">:</span> <span class="s">&#39;&#39;</span><span class="p">;</span>
        <span class="nv">$Title</span> <span class="o">=</span> <span class="nv">$Value</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>

        <span class="c1"># show the mask and not the value</span>
        <span class="nv">$Value</span> <span class="o">=</span> <span class="nv">$Param</span><span class="p">{</span><span class="n">DynamicFieldConfig</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">Config</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">ValueMask</span><span class="p">}</span> <span class="o">||</span> <span class="s">&#39;&#39;</span><span class="p">;</span>
        <span class="nv">$Title</span> <span class="o">=</span> <span class="s">&#39;The value of this field is hidden.&#39;</span>
    <span class="p">}</span>

    <span class="c1"># HTMLOutput transformations</span>
    <span class="k">if</span> <span class="p">(</span> <span class="nv">$Param</span><span class="p">{</span><span class="n">HTMLOutput</span><span class="p">}</span> <span class="p">)</span> <span class="p">{</span>
        <span class="nv">$Value</span> <span class="o">=</span> <span class="nv">$Param</span><span class="p">{</span><span class="n">LayoutObject</span><span class="p">}</span><span class="o">-&gt;</span><span class="n">Ascii2Html</span><span class="p">(</span>
            <span class="n">Text</span> <span class="o">=&gt;</span> <span class="nv">$Value</span><span class="p">,</span>
            <span class="n">Max</span> <span class="o">=&gt;</span> <span class="nv">$Param</span><span class="p">{</span><span class="n">ValueMaxChars</span><span class="p">}</span> <span class="o">||</span> <span class="s">&#39;&#39;</span><span class="p">,</span>
        <span class="p">);</span>

        <span class="nv">$Title</span> <span class="o">=</span> <span class="nv">$Param</span><span class="p">{</span><span class="n">LayoutObject</span><span class="p">}</span><span class="o">-&gt;</span><span class="n">Ascii2Html</span><span class="p">(</span>
            <span class="n">Text</span> <span class="o">=&gt;</span> <span class="nv">$Title</span><span class="p">,</span>
            <span class="n">Max</span> <span class="o">=&gt;</span> <span class="nv">$Param</span><span class="p">{</span><span class="n">TitleMaxChars</span><span class="p">}</span> <span class="o">||</span> <span class="s">&#39;&#39;</span><span class="p">,</span>
        <span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span> <span class="nv">$Param</span><span class="p">{</span><span class="n">ValueMaxChars</span><span class="p">}</span> <span class="o">&amp;&amp;</span> <span class="nb">length</span><span class="p">(</span><span class="nv">$Value</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nv">$Param</span><span class="p">{</span><span class="n">ValueMaxChars</span><span class="p">}</span> <span class="p">)</span> <span class="p">{</span>
            <span class="nv">$Value</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span> <span class="nv">$Value</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">$Param</span><span class="p">{</span><span class="n">ValueMaxChars</span><span class="p">}</span> <span class="p">)</span> <span class="o">.</span> <span class="s">&#39;...&#39;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span> <span class="nv">$Param</span><span class="p">{</span><span class="n">TitleMaxChars</span><span class="p">}</span> <span class="o">&amp;&amp;</span> <span class="nb">length</span><span class="p">(</span><span class="nv">$Title</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nv">$Param</span><span class="p">{</span><span class="n">TitleMaxChars</span><span class="p">}</span> <span class="p">)</span> <span class="p">{</span>
            <span class="nv">$Title</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span> <span class="nv">$Title</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">$Param</span><span class="p">{</span><span class="n">TitleMaxChars</span><span class="p">}</span> <span class="p">)</span> <span class="o">.</span> <span class="s">&#39;...&#39;</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1"># create return structure</span>
    <span class="k">my</span> <span class="nv">$Data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">Value</span> <span class="o">=&gt;</span> <span class="nv">$Value</span><span class="p">,</span>
        <span class="n">Title</span> <span class="o">=&gt;</span> <span class="nv">$Title</span><span class="p">,</span>
    <span class="p">};</span>

    <span class="k">return</span> <span class="nv">$Data</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">DisplayValueRender()</span></code> function returns the field value as plain text, as well as its title (both can be translated). For this particular example we are checking if the password should be revealed or display a predefined mask by a configuration parameter in the dynamic field.</p>
<div class="highlight-Perl notranslate"><div class="highlight"><pre><span></span><span class="k">sub</span> <span class="nf">ReadableValueRender</span> <span class="p">{</span>
    <span class="k">my</span> <span class="p">(</span> <span class="nv">$Self</span><span class="p">,</span> <span class="nv">%Param</span> <span class="p">)</span> <span class="o">=</span> <span class="nv">@_</span><span class="p">;</span>

    <span class="k">my</span> <span class="nv">$Value</span><span class="p">;</span>
    <span class="k">my</span> <span class="nv">$Title</span><span class="p">;</span>

    <span class="c1"># check if field is set to show password or not</span>
    <span class="k">if</span> <span class="p">(</span>
        <span class="nb">defined</span> <span class="nv">$Param</span><span class="p">{</span><span class="n">DynamicFieldConfig</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">Config</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">ShowValue</span><span class="p">}</span>
        <span class="o">&amp;&amp;</span> <span class="nv">$Param</span><span class="p">{</span><span class="n">DynamicFieldConfig</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">Config</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">ShowValue</span><span class="p">}</span> <span class="ow">eq</span> <span class="s">&#39;Yes&#39;</span>
        <span class="p">)</span>
    <span class="p">{</span>

        <span class="c1"># get raw Title and Value strings from field value</span>
        <span class="nv">$Value</span> <span class="o">=</span> <span class="nv">$Param</span><span class="p">{</span><span class="n">Value</span><span class="p">}</span> <span class="sr">//</span> <span class="s">&#39;&#39;</span><span class="p">;</span>
        <span class="nv">$Title</span> <span class="o">=</span> <span class="nv">$Value</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>

        <span class="c1"># show the mask and not the value</span>
        <span class="nv">$Value</span> <span class="o">=</span> <span class="nv">$Param</span><span class="p">{</span><span class="n">DynamicFieldConfig</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">Config</span><span class="p">}</span><span class="o">-&gt;</span><span class="p">{</span><span class="n">ValueMask</span><span class="p">}</span> <span class="o">||</span> <span class="s">&#39;&#39;</span><span class="p">;</span>
        <span class="nv">$Title</span> <span class="o">=</span> <span class="s">&#39;The value of this field is hidden.&#39;</span>
    <span class="p">}</span>

    <span class="c1"># cut strings if needed</span>
    <span class="k">if</span> <span class="p">(</span> <span class="nv">$Param</span><span class="p">{</span><span class="n">ValueMaxChars</span><span class="p">}</span> <span class="o">&amp;&amp;</span> <span class="nb">length</span><span class="p">(</span><span class="nv">$Value</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nv">$Param</span><span class="p">{</span><span class="n">ValueMaxChars</span><span class="p">}</span> <span class="p">)</span> <span class="p">{</span>
        <span class="nv">$Value</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span> <span class="nv">$Value</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">$Param</span><span class="p">{</span><span class="n">ValueMaxChars</span><span class="p">}</span> <span class="p">)</span> <span class="o">.</span> <span class="s">&#39;...&#39;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span> <span class="nv">$Param</span><span class="p">{</span><span class="n">TitleMaxChars</span><span class="p">}</span> <span class="o">&amp;&amp;</span> <span class="nb">length</span><span class="p">(</span><span class="nv">$Title</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nv">$Param</span><span class="p">{</span><span class="n">TitleMaxChars</span><span class="p">}</span> <span class="p">)</span> <span class="p">{</span>
        <span class="nv">$Title</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span> <span class="nv">$Title</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">$Param</span><span class="p">{</span><span class="n">TitleMaxChars</span><span class="p">}</span> <span class="p">)</span> <span class="o">.</span> <span class="s">&#39;...&#39;</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1"># create return structure</span>
    <span class="k">my</span> <span class="nv">$Data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">Value</span> <span class="o">=&gt;</span> <span class="nv">$Value</span><span class="p">,</span>
        <span class="n">Title</span> <span class="o">=&gt;</span> <span class="nv">$Title</span><span class="p">,</span>
    <span class="p">};</span>

    <span class="k">return</span> <span class="nv">$Data</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This function is similar to <code class="docutils literal notranslate"><span class="pre">DisplayValueRender()</span></code> but it is used in locations, where no <code class="docutils literal notranslate"><span class="pre">LayoutObject</span></code> is available.</p>
<div class="section" id="other-functions-legacy-api">
<h5>Other Functions (Legacy API)<a class="headerlink" href="#other-functions-legacy-api" title="Permalink to this headline">¶</a></h5>
<p>The following are other functions, that might be needed, if the new dynamic field does not inherit from other classes.</p>
<p>To see the complete code of this functions, please take a look directly into the file <code class="docutils literal notranslate"><span class="pre">Kernel/System/DynamicFieldLegacy/Driver/Base.pm</span></code>.</p>
<div class="highlight-Perl notranslate"><div class="highlight"><pre><span></span><span class="k">sub</span> <span class="nf">ValueGet</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>
</pre></div>
</div>
<p>This function retrieves the value from the field on a specified object. In this case we are returning the first text value, since the field only stores one text value at time.</p>
<div class="highlight-Perl notranslate"><div class="highlight"><pre><span></span><span class="k">sub</span> <span class="nf">ValueSet</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>
</pre></div>
</div>
<p>This function is used to store a dynamic field value. In this case this field only stores one text type value. Other fields could store more than one value on either <code class="docutils literal notranslate"><span class="pre">ValueText</span></code>, <code class="docutils literal notranslate"><span class="pre">ValueDateTime</span></code> or
<code class="docutils literal notranslate"><span class="pre">ValueInt</span></code> format.</p>
<div class="highlight-Perl notranslate"><div class="highlight"><pre><span></span><span class="k">sub</span> <span class="nf">ValueDelete</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>
</pre></div>
</div>
<p>This function is used to delete one field value attached to a particular object ID. For example if the instance of an object is to be deleted, then there is no reason to have the field value stored in the database for that particular object instance.</p>
<div class="highlight-Perl notranslate"><div class="highlight"><pre><span></span><span class="k">sub</span> <span class="nf">AllValuesDelete</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>
</pre></div>
</div>
<p>This function is used to delete all values from a certain dynamic field. This function is very useful when a dynamic field is going to be deleted.</p>
<div class="highlight-Perl notranslate"><div class="highlight"><pre><span></span><span class="k">sub</span> <span class="nf">ValueValidate</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>
</pre></div>
</div>
<p>This function is used to check if the value is consistent to its type.</p>
<div class="highlight-Perl notranslate"><div class="highlight"><pre><span></span><span class="k">sub</span> <span class="nf">SearchSQLGet</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>
</pre></div>
</div>
<p>This function is used by <code class="docutils literal notranslate"><span class="pre">TicketSearch</span></code> core module to build the internal query to search for a ticket based on this field as a search parameter.</p>
<div class="highlight-Perl notranslate"><div class="highlight"><pre><span></span><span class="k">sub</span> <span class="nf">SearchSQLOrderFieldGet</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>
</pre></div>
</div>
<p>This function is also a helper for <code class="docutils literal notranslate"><span class="pre">TicketSearch</span></code> module. <code class="docutils literal notranslate"><span class="pre">$Param{TableAlias}</span></code> should be kept and <code class="docutils literal notranslate"><span class="pre">value_text</span></code> could be replaced with <code class="docutils literal notranslate"><span class="pre">value_date</span></code> or <code class="docutils literal notranslate"><span class="pre">value_int</span></code> depending on the field.</p>
<div class="highlight-Perl notranslate"><div class="highlight"><pre><span></span><span class="k">sub</span> <span class="nf">EditFieldValueGet</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>
</pre></div>
</div>
<p>This function is used in the edit screens of OTRS and its purpose is to get the value of the field, either from a template like generic agent profile or from a web request. This function gets the web request in the <code class="docutils literal notranslate"><span class="pre">$Param{ParamObject}</span></code>, that is a copy of the <code class="docutils literal notranslate"><span class="pre">ParamObject</span></code> of the front end module or screen.</p>
<p>There are two return formats for this function. The normal that is just the raw value or a structure that is the pair field name =&gt; field value. For example a date dynamic field returns normally the date as string, and if it should return a structure it returns a pair for each part of the date in the hash.</p>
<p>If the result should be a structure then, normally this is used to store its values in a template, like a generic agent profile. For example a date field uses several HTML components to build the field, like the
used checkbox and selects for year, month, day etc.</p>
<div class="highlight-Perl notranslate"><div class="highlight"><pre><span></span><span class="k">sub</span> <span class="nf">EditFieldValueValidate</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>
</pre></div>
</div>
<p>This function should provide at least a method to validate if the field is empty, and return an error if the field is empty and mandatory, but it can also do more validations for other kind of fields, like if the option selected is valid, or if a date should be only in the past etc. It can provide a custom error message also.</p>
<div class="highlight-Perl notranslate"><div class="highlight"><pre><span></span><span class="k">sub</span> <span class="nf">SearchFieldRender</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>
</pre></div>
</div>
<p>This function is used by ticket search dialog and it is similar to <code class="docutils literal notranslate"><span class="pre">EditFieldRander()</span></code>, but normally on a search screen small changes has to be done for all fields. For this example we use a HTML text input instead of a password input. In other fields like drop-down field is displayed as a multiple select in order to let the user search for more than one value at a time.</p>
<div class="highlight-Perl notranslate"><div class="highlight"><pre><span></span><span class="k">sub</span> <span class="nf">SearchFieldValueGet</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>
</pre></div>
</div>
<p>Very similar to <code class="docutils literal notranslate"><span class="pre">EditFieldValueGet()</span></code>, but uses a different name prefix, adapted for the search dialog screen.</p>
<div class="highlight-Perl notranslate"><div class="highlight"><pre><span></span><span class="k">sub</span> <span class="nf">SearchFieldParameterBuild</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>
</pre></div>
</div>
<p>This function is used also by the ticket search dialog to set the correct operator and value to do the search on this field. It also returns how the value should be displayed in the used search attributes in the results page.</p>
<div class="highlight-Perl notranslate"><div class="highlight"><pre><span></span><span class="k">sub</span> <span class="nf">StatsFieldParameterBuild</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>
</pre></div>
</div>
<p>This function is used by the stats modules. It includes the field definition in the stats format. For fields with fixed values it also includes all this possible values and if they can be translated, take a look to the <code class="docutils literal notranslate"><span class="pre">BaseSelect</span></code> driver code for an example how to implement those.</p>
<div class="highlight-Perl notranslate"><div class="highlight"><pre><span></span><span class="k">sub</span> <span class="nf">StatsSearchFieldParameterBuild</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>
</pre></div>
</div>
<p>This function is very similar to the <code class="docutils literal notranslate"><span class="pre">SearchFieldParameterBuild()</span></code>. The difference is that the
latter gets the value from the search profile and this one gets the value directly from its parameters.</p>
<p>This function is used by statistics module.</p>
<div class="highlight-Perl notranslate"><div class="highlight"><pre><span></span><span class="k">sub</span> <span class="nf">TemplateValueTypeGet</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>
</pre></div>
</div>
<p>This function is used to know how the dynamic field values stored on a profile should be retrieved, as a scalar or as an array, and it also defines the correct name of the field in the profile.</p>
<div class="highlight-Perl notranslate"><div class="highlight"><pre><span></span><span class="k">sub</span> <span class="nf">RandomValueSet</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>
</pre></div>
</div>
<p>This function is used by <code class="docutils literal notranslate"><span class="pre">otrs.FillDB.pl</span></code> script to populate the database with some test and random data. The value inserted by this function is not really relevant. The only restriction is that the value must be compatible with the field value type.</p>
<div class="highlight-Perl notranslate"><div class="highlight"><pre><span></span><span class="k">sub</span> <span class="nf">ObjectMatch</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>
</pre></div>
</div>
<p>Used by the notification modules. This function returns 1 if the field is present in the <code class="docutils literal notranslate"><span class="pre">$Param{ObjectAttributes}</span></code> parameter and if it matches the given value.</p>
</div>
</div>
<div class="section" id="dynamic-field-driver-example-new-api">
<h4>Dynamic Field Driver Example (New API)<a class="headerlink" href="#dynamic-field-driver-example-new-api" title="Permalink to this headline">¶</a></h4>
<div class="highlight-Perl notranslate"><div class="highlight"><pre><span></span><span class="c1"># --</span>
<span class="c1"># Kernel/System/DynamicField/Driver/Password.pm - Driver for DynamicField backend</span>
<span class="c1"># Copyright (C) 2001-2019 OTRS AG, https://otrs.com/</span>
<span class="c1"># --</span>
<span class="c1"># This software comes with ABSOLUTELY NO WARRANTY. For details, see</span>
<span class="c1"># the enclosed file COPYING for license information (GPL). If you</span>
<span class="c1"># did not receive this file, see https://www.gnu.org/licenses/gpl-3.0.txt.</span>
<span class="c1"># --</span>

<span class="k">package</span> <span class="nn">Kernel::System::DynamicField::Driver::Password</span><span class="p">;</span>

<span class="k">use</span> <span class="nn">strict</span><span class="p">;</span>
<span class="k">use</span> <span class="nn">warnings</span><span class="p">;</span>

<span class="k">use</span> <span class="nn">Moose</span><span class="p">;</span>

<span class="n">extends</span> <span class="s">&#39;Kernel::System::DynamicField::Driver::Base::Text&#39;</span><span class="p">;</span>

<span class="k">our</span> <span class="nv">@ObjectDependencies</span> <span class="o">=</span> <span class="p">();</span>
</pre></div>
</div>
<p>This is the common header that can be found in the new OTRS modules since OTRS 7.</p>
<p>The class/package name is declared via the <code class="docutils literal notranslate"><span class="pre">package</span></code> keyword. Note that the <code class="docutils literal notranslate"><span class="pre">Base::Text</span></code> is used as the base class.</p>
<p>There’s no need to declare the constructor <code class="docutils literal notranslate"><span class="pre">BUILD</span></code>, unless you need to do something really specific to the driver, during the creation of a new class instance.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Drivers are created only by the <code class="docutils literal notranslate"><span class="pre">DynamicFieldObject</span></code> and not directly from any other module.</p>
</div>
<div class="highlight-Perl notranslate"><div class="highlight"><pre><span></span><span class="n">override</span> <span class="s">&#39;FormFieldSchema&#39;</span> <span class="o">=&gt;</span> <span class="k">sub</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="nv">%</span><span class="p">{</span> <span class="n">super</span><span class="p">()</span> <span class="p">},</span>
        <span class="n">Type</span> <span class="o">=&gt;</span> <span class="s">&#39;FormPassword&#39;</span><span class="p">,</span>
    <span class="p">};</span>
<span class="p">};</span>
</pre></div>
</div>
<p>This function is responsible to return the schema of the field, that should be used in edit screens, like <code class="docutils literal notranslate"><span class="pre">AgentTicketPhone</span></code>, <code class="docutils literal notranslate"><span class="pre">AgentTicketNote</span></code>, etc.</p>
<div class="section" id="other-functions-new-api">
<h5>Other Functions (New API)<a class="headerlink" href="#other-functions-new-api" title="Permalink to this headline">¶</a></h5>
<p>The following are other functions, that are might be needed to implement or override, according to the specification of the driver. Please refer to the file <code class="docutils literal notranslate"><span class="pre">Kernel/System/DynamicField/Driver/Base.pm</span></code>.</p>
<div class="highlight-Perl notranslate"><div class="highlight"><pre><span></span><span class="k">sub</span> <span class="nf">ValueGet</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>
</pre></div>
</div>
<p>This function retrieves the value from the field, on a specific object. In this case, we are returning the first text value, since the field only stores one text value at a time.</p>
<div class="highlight-Perl notranslate"><div class="highlight"><pre><span></span><span class="k">sub</span> <span class="nf">ValueSet</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>
</pre></div>
</div>
<p>This function is used to store a dynamic field value. In this case, this field only stores one text type value. Other fields could store more than one value on either <code class="docutils literal notranslate"><span class="pre">Text</span></code>, <code class="docutils literal notranslate"><span class="pre">DateTime</span></code> or <code class="docutils literal notranslate"><span class="pre">Integer</span></code> format.</p>
<div class="highlight-Perl notranslate"><div class="highlight"><pre><span></span><span class="k">sub</span> <span class="nf">ValueDelete</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>
</pre></div>
</div>
<p>This function is used to delete the values of a certain dynamic field. If no filter is passed, all the values will be deleted. To execute the deletion only for one object, we can pass the filter <code class="docutils literal notranslate"><span class="pre">Filters</span> <span class="pre">=&gt;</span> <span class="pre">{</span> <span class="pre">ObjectID</span> <span class="pre">=&gt;</span> <span class="pre">'...'</span> <span class="pre">}</span></code>.</p>
<div class="highlight-Perl notranslate"><div class="highlight"><pre><span></span><span class="k">sub</span> <span class="nf">ValueValidate</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>
</pre></div>
</div>
<p>This function is used to check, if the value is consistent to its type and dynamic field instance.</p>
<div class="highlight-Perl notranslate"><div class="highlight"><pre><span></span>sub ValueList { ... }
</pre></div>
</div>
<p>This function is used to get the list of the values for the dynamic field instance.</p>
<div class="highlight-Perl notranslate"><div class="highlight"><pre><span></span><span class="k">sub</span> <span class="nf">SearchSQLGet</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>
</pre></div>
</div>
<p>This function is used by <code class="docutils literal notranslate"><span class="pre">TicketSearch</span></code> core module, to build the internal query that searches for a ticket, based on this field as a search parameter.</p>
<div class="highlight-Perl notranslate"><div class="highlight"><pre><span></span><span class="k">sub</span> <span class="nf">SearchSQLOrderFieldGet</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>
</pre></div>
</div>
<p>This function is also a helper for <code class="docutils literal notranslate"><span class="pre">TicketSearch</span></code> module. <code class="docutils literal notranslate"><span class="pre">$Param{TableAlias}</span></code> should be kept and <code class="docutils literal notranslate"><span class="pre">_ValueDBColumn()</span></code> changed in case the driver uses multiple columns, to store it’s data.</p>
<div class="highlight-Perl notranslate"><div class="highlight"><pre><span></span><span class="k">sub</span> <span class="nf">SearchConditionGet</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>
</pre></div>
</div>
<p>This function is used by the ticket search and statistics module, to set the correct operator and value to the search on this field.</p>
<div class="highlight-Perl notranslate"><div class="highlight"><pre><span></span><span class="k">sub</span> <span class="nf">RandomValueSet</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>
</pre></div>
</div>
<p>This function is used by <code class="docutils literal notranslate"><span class="pre">otrs.FillDB.pl</span></code> script, to populate the database with some test and random data. The value inserted by this function is not really relevant. The only restriction is, that the value must be compatible with the field value type.</p>
</div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          

<script>
// Start Google Analytics Tracking
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-28118796-2', 'auto');
ga('send', 'pageview');
// End Google Analytics Tracking
</script>

<footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="dynamic-fields-extend.html" class="btn btn-neutral float-right" title="Creating a Dynamic Field Functionality Extension" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="dynamic-fields-extend-options.html" class="btn btn-neutral" title="How To Extend The Dynamic Fields" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2001-2020 OTRS AG, https://otrs.com/

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    

  

  <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>